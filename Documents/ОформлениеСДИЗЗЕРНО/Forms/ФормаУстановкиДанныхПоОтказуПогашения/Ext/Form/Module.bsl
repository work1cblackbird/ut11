
#Область ОбработчикиСобытийФормы

&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	
	Если Параметры.Свойство("АвтоТест") Тогда // Возврат при получении формы для анализа.
		Возврат;
	КонецЕсли;
	
	ПричинаОтказаОтГашения = Параметры.ПричинаОтказаОтГашения;
	Примечание             = Параметры.Примечание;
	ТолькоПросмотр         = Параметры.ТолькоПросмотр;
	
	Если ТолькоПросмотр Тогда
		
		Элементы.ФормаСохранить.Заголовок                   = НСтр("ru = 'Закрыть'");
		Элементы.ГруппаДанныеОтказаПогашения.ТолькоПросмотр = Истина;
		
		СтандартнаяПричинаОтказа = Документы.ОформлениеСДИЗЗЕРНО.ДанныеПричиныОтказаОтПогашенияПоУмолчанию();
		
		Если Не ЗначениеЗаполнено(ПричинаОтказаОтГашения) Тогда
			Элементы.ПричинаОтказаОтГашения.ПодсказкаВвода = СтандартнаяПричинаОтказа.Причина;
		КонецЕсли;
		
		Если Не ЗначениеЗаполнено(Примечание) Тогда
			Элементы.Примечание.ПодсказкаВвода             = СтандартнаяПричинаОтказа.Примечание;
		КонецЕсли;
		
	КонецЕсли;
	
КонецПроцедуры

#КонецОбласти

#Область ОбработчикиКомандФормы

&НаКлиенте
Процедура Сохранить(Команда)
	
	Отказ = Ложь;
	
	Если ТолькоПросмотр Тогда
		
		Закрыть();
		Возврат;
		
	КонецЕсли;
	
	Если Не ЗначениеЗаполнено(ПричинаОтказаОтГашения) Тогда
		
		ОбщегоНазначенияКлиент.СообщитьПользователю(НСтр("ru = 'Укажите причину отказа от гашения.'"),,
			"ПричинаОтказаОтГашения",, Отказ);
			
	КонецЕсли;
	
	Если Не ЗначениеЗаполнено(Примечание) Тогда
		
		ОбщегоНазначенияКлиент.СообщитьПользователю(НСтр("ru = 'Укажите текстовое описание для отказа от гашения.'"),,
			"Примечание",, Отказ);
			
	КонецЕсли;
	
	Если Отказ Тогда
		Возврат;
	КонецЕсли;
	
	СтруктураВозврата = Новый Структура("ПричинаОтказаОтГашения, Примечание",
		ПричинаОтказаОтГашения, Примечание);
		
	Закрыть(СтруктураВозврата);
	
КонецПроцедуры

#КонецОбласти