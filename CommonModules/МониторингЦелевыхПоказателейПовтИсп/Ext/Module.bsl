////////////////////////////////////////////////////////////////////////////////
// МОДУЛЬ СОДЕРЖИТ ПРОЦЕДУРЫ ПОЛУЧЕНИЯ ПЕРЕМЕННЫХ ДЛЯ ФОРМИРОВАНИЯ УПР. ОТЧ.
//
////////////////////////////////////////////////////////////////////////////////

#Область ПрограммныйИнтерфейс

// Возвращает макет электронной формы анализа показателя
//
// Возвращаемое значение:
//  ТабличныйДокумент - макет табличного документа.
//
Функция МакетСтраницыПоказателя() Экспорт
	
	Перем МакетСтраницыПоказателя;
	
	МакетСтраницыПоказателя = Отчеты.МониторЦелевыхПоказателей.ПолучитьМакет("МакетСтраницыПоказателя");
	
	Возврат МакетСтраницыПоказателя;
	
КонецФункции

// Возвращает макет электронной формы анализа показателя
//
// Возвращаемое значение:
//  ТабличныйДокумент - макет табличного документа.
//
Функция ПолучитьМатрицуСостояний() Экспорт
	
	МакетМатрицаСостоянийПоказателей = Отчеты.МониторЦелевыхПоказателей.ПолучитьМакет("МатрицаСостоянийПоказателей");
	МакетМатрицаСостоянийПоказателей.КодЯзыка = КодЯзыкаКонфигурации();
	
	Возврат МакетМатрицаСостоянийПоказателей;
	
КонецФункции

// Возвращает строковое представление пояснения к тренду на языке текущего пользователя.
//
// Параметры:
//  ПояснениеКТренду - Строка - Строка пояснения к тренду из макета матрицы состояний.
// 
// Возвращаемое значение:
//  Строка - Строка пояснения к тренду на языке текущего пользователя.
//
Функция ПредставлениеПоясненияКТрендуМатрицыСостояния(ПояснениеКТренду) Экспорт
	Представление = "";
	Если ПояснениеКТренду = "БезИзмененийПоСравнениюСПредыдущимЗначением" Тогда
		Представление = НСтр("ru = 'Без изменений по сравнению с предыдущим значением'");
	ИначеЕсли ПояснениеКТренду = "ЗначенияУменьшаютсяНаправлениеПротивоположноеУстановленномуТренду" Тогда
		Представление = НСтр("ru = 'Значения уменьшаются. Направление противоположное установленному тренду'");
	ИначеЕсли ПояснениеКТренду = "ЗначенияУвеличиваютсяНаправлениеСоответствуетУстановленномуТренду" Тогда
		Представление = НСтр("ru = 'Значения увеличиваются. Направление соответствует установленному тренду'");
	ИначеЕсли ПояснениеКТренду = "ЗначенияУменьшаются" Тогда
		Представление = НСтр("ru = 'Значения уменьшаются'");
	ИначеЕсли ПояснениеКТренду = "ЗначенияУвеличиваются" Тогда
		Представление = НСтр("ru = 'Значения увеличиваются'");
	ИначеЕсли ПояснениеКТренду = "ХарактерИзмененийНеопределен" Тогда
		Представление = НСтр("ru = 'Характер изменений неопределен'");
	ИначеЕсли ПояснениеКТренду = "ЗначенияУменьшаютсяНаправлениеСоответствуетУстановленномуТренду" Тогда
		Представление = НСтр("ru = 'Значения уменьшаются. Направление соответствует установленному тренду'");
	ИначеЕсли ПояснениеКТренду = "ЗначенияУвеличиваютсяНаправлениеПротивоположноеУстановленномуТренду" Тогда
		Представление = НСтр("ru = 'Значения увеличиваются. Направление противоположное установленному тренду'");
	ИначеЕсли ПояснениеКТренду = "ЗначенияУменьшаютсяВПределахЦелевогоДиапазона" Тогда
		Представление = НСтр("ru = 'Значения уменьшаются в пределах целевого диапазона'");
	ИначеЕсли ПояснениеКТренду = "ЗначенияУвеличиваютсяВПределахЦелевогоДиапазона" Тогда
		Представление = НСтр("ru = 'Значения увеличиваются в пределах целевого диапазона'");
	КонецЕсли;
	
	Возврат Представление;
КонецФункции

// Возвращает строковое представление пояснения к статусу на языке текущего пользователя.
//
// Параметры:
//  ПояснениеКСтатусу - Строка - Строка пояснения к статусу из макета матрицы состояний.
// 
// Возвращаемое значение:
//  Строка - Строка пояснения к статусу на языке текущего пользователя.
//
Функция ПредставлениеПоясненияКСтатусуМатрицыСостояния(ПояснениеКСтатусу) Экспорт
	Представление = "";
	Если ПояснениеКСтатусу = "ЦельДостигнута" Тогда
		Представление = НСтр("ru = 'Цель достигнута'");
	ИначеЕсли ПояснениеКСтатусу = "ПриемлемоеСостояниеПоказателя" Тогда
		Представление = НСтр("ru = 'Приемлемое состояние показателя'");
	ИначеЕсли ПояснениеКСтатусу = "НеприемлемоеСостояниеПоказателя" Тогда
		Представление = НСтр("ru = 'Неприемлемое состояние показателя'");
	ИначеЕсли ПояснениеКСтатусу = "СостояниеПоказателяНеОпределено" Тогда
		Представление = НСтр("ru = 'Состояние показателя не определено'");
	ИначеЕсли ПояснениеКСтатусу = "РассчитаноСОшибками" Тогда
		Представление = НСтр("ru = 'Рассчитано с ошибками'");
	КонецЕсли;
	
	Возврат Представление;
КонецФункции

// Возвращает область "РазделительБлоков" макета электронной формы анализа показателя.
//
// Возвращаемое значение:
//  ТабличныйДокумент - макет области табличного документа документа, для разделения блоков информации.
//
Функция ПолучитьРазделительПечатнойФормыВариантаАнализа() Экспорт
	
	Перем РазделительБлоков;
	
	МакетПечатнойФормыВариантаАнализа = МакетСтраницыПоказателя();
	РазделительБлоков = МакетПечатнойФормыВариантаАнализа.ПолучитьОбласть("РазделительБлоков");
	
	Возврат РазделительБлоков;
	
КонецФункции

#Область ПреобразованиеЦветовRGBHSV

// Возвращает таблицу соответствия web цветов и составляющих цветов - красного, зеленого, синего.
// 
// Возвращаемое значение:
//  ТаблицаЗначений - таблица соответствия web цветов и составляющих цветов:
//   *ВебЦвет - WebЦвета - цвет.
//   *Красный - Число - Тон красного цвета по RGB.
//   *Зеленый - Число - Тон зеленого цвета по RGB.
//   *Синий   - Число - Тон синего цвета по RGB.
//
Функция СоставляющиеВебЦветов() Экспорт
	
	Таблица = Новый ТаблицаЗначений();
	Таблица.Колонки.Добавить("ВебЦвет", Новый ОписаниеТипов("Цвет"));
	Таблица.Колонки.Добавить("Красный", Новый ОписаниеТипов("Число",,, Новый КвалификаторыЧисла(3, 0, ДопустимыйЗнак.Неотрицательный)));
	Таблица.Колонки.Добавить("Зеленый", Новый ОписаниеТипов("Число",,, Новый КвалификаторыЧисла(3, 0, ДопустимыйЗнак.Неотрицательный)));
	Таблица.Колонки.Добавить("Синий", Новый ОписаниеТипов("Число",,, Новый КвалификаторыЧисла(3, 0, ДопустимыйЗнак.Неотрицательный)));
	
	ДобавитьЗапись(Таблица, WebЦвета.АкварельноСиний, 240, 248, 255);
	ДобавитьЗапись(Таблица, WebЦвета.АнтикБелый, 250, 235, 215);
	ДобавитьЗапись(Таблица, WebЦвета.ЦианАкварельный, 0, 255, 255);
	ДобавитьЗапись(Таблица, WebЦвета.Аквамарин, 127, 255, 212);
	ДобавитьЗапись(Таблица, WebЦвета.Лазурный, 240, 255, 255);
	ДобавитьЗапись(Таблица, WebЦвета.Бежевый, 245, 245, 220);
	ДобавитьЗапись(Таблица, WebЦвета.СветлоКоричневый, 255, 228, 196);
	ДобавитьЗапись(Таблица, WebЦвета.Черный, 0, 0, 0);
	ДобавитьЗапись(Таблица, WebЦвета.БледноМиндальный, 255, 235, 205);
	ДобавитьЗапись(Таблица, WebЦвета.Синий, 0, 0, 255);
	ДобавитьЗапись(Таблица, WebЦвета.СинеФиолетовый, 138, 43, 226);
	ДобавитьЗапись(Таблица, WebЦвета.Коричневый, 165, 42, 42);
	ДобавитьЗапись(Таблица, WebЦвета.Древесный, 222, 184, 135);
	ДобавитьЗапись(Таблица, WebЦвета.СероСиний, 95, 158, 160);
	ДобавитьЗапись(Таблица, WebЦвета.ЗеленоватоЖелтый, 127, 255, 0);
	ДобавитьЗапись(Таблица, WebЦвета.Шоколадный, 210, 105, 30);
	ДобавитьЗапись(Таблица, WebЦвета.Коралловый, 255, 127, 80);
	ДобавитьЗапись(Таблица, WebЦвета.Васильковый, 100, 149, 237);
	ДобавитьЗапись(Таблица, WebЦвета.ШелковыйОттенок, 255, 248, 220);
	ДобавитьЗапись(Таблица, WebЦвета.Кремовый, 255, 251, 240);
	ДобавитьЗапись(Таблица, WebЦвета.Малиновый, 220, 20, 60);
	ДобавитьЗапись(Таблица, WebЦвета.Циан, 0, 255, 255);
	ДобавитьЗапись(Таблица, WebЦвета.ТемноСиний, 0, 0, 139);
	ДобавитьЗапись(Таблица, WebЦвета.ЦианТемный, 0, 139, 139);
	ДобавитьЗапись(Таблица, WebЦвета.ТемноЗолотистый, 184, 134, 11);
	ДобавитьЗапись(Таблица, WebЦвета.ТемноСерый, 169, 169, 169);
	ДобавитьЗапись(Таблица, WebЦвета.ТемноЗеленый, 0, 100, 0);
	ДобавитьЗапись(Таблица, WebЦвета.ХакиТемный, 189, 183, 107);
	ДобавитьЗапись(Таблица, WebЦвета.ФуксинТемный, 139, 0, 139);
	ДобавитьЗапись(Таблица, WebЦвета.ТемноОливковоЗеленый, 85, 107, 47);
	ДобавитьЗапись(Таблица, WebЦвета.ТемноОранжевый, 255, 140, 0);
	ДобавитьЗапись(Таблица, WebЦвета.ОрхидеяТемный, 153, 50, 204);
	ДобавитьЗапись(Таблица, WebЦвета.ТемноКрасный, 139, 0, 0);
	ДобавитьЗапись(Таблица, WebЦвета.ЛососьТемный, 233, 150, 122);
	ДобавитьЗапись(Таблица, WebЦвета.ЦветМорскойВолныТемный, 143, 188, 143);
	ДобавитьЗапись(Таблица, WebЦвета.ТемноГрифельноСиний, 72, 61, 139);
	ДобавитьЗапись(Таблица, WebЦвета.ТемноГрифельноСерый, 47, 79, 79);
	ДобавитьЗапись(Таблица, WebЦвета.ТемноБирюзовый, 0, 206, 209);
	ДобавитьЗапись(Таблица, WebЦвета.ТемноФиолетовый, 148, 0, 211);
	ДобавитьЗапись(Таблица, WebЦвета.НасыщенноРозовый, 255, 20, 147);
	ДобавитьЗапись(Таблица, WebЦвета.НасыщенноНебесноГолубой, 0, 191, 255);
	ДобавитьЗапись(Таблица, WebЦвета.ТусклоСерый, 105, 105, 105);
	ДобавитьЗапись(Таблица, WebЦвета.СинеСерый, 30, 144, 255);
	ДобавитьЗапись(Таблица, WebЦвета.Кирпичный, 178, 34, 34);
	ДобавитьЗапись(Таблица, WebЦвета.ЦветокБелый, 255, 250, 240);
	ДобавитьЗапись(Таблица, WebЦвета.ЗеленыйЛес, 34, 139, 34);
	ДобавитьЗапись(Таблица, WebЦвета.Фуксия, 255, 0, 255);
	ДобавитьЗапись(Таблица, WebЦвета.СеребристоСерый, 220, 220, 220);
	ДобавитьЗапись(Таблица, WebЦвета.ПризрачноБелый, 248, 248, 255);
	ДобавитьЗапись(Таблица, WebЦвета.Золотой, 255, 215, 0);
	ДобавитьЗапись(Таблица, WebЦвета.Золотистый, 218, 165, 32);
	ДобавитьЗапись(Таблица, WebЦвета.Серый, 128, 128, 128);
	ДобавитьЗапись(Таблица, WebЦвета.Зеленый, 173, 255, 47);
	ДобавитьЗапись(Таблица, WebЦвета.ЗеленоЖелтый, 190, 190, 190);
	ДобавитьЗапись(Таблица, WebЦвета.Роса, 240, 255, 240);
	ДобавитьЗапись(Таблица, WebЦвета.ТеплоРозовый, 255, 105, 180);
	ДобавитьЗапись(Таблица, WebЦвета.Киноварь, 205, 92, 92);
	ДобавитьЗапись(Таблица, WebЦвета.Индиго, 75, 0, 130);
	ДобавитьЗапись(Таблица, WebЦвета.СлоноваяКость, 255, 255, 240);
	ДобавитьЗапись(Таблица, WebЦвета.Хаки, 240, 230, 140);
	ДобавитьЗапись(Таблица, WebЦвета.БледноЛиловый, 230, 230, 250);
	ДобавитьЗапись(Таблица, WebЦвета.ГолубойСКраснымОттенком, 255, 240, 245);
	ДобавитьЗапись(Таблица, WebЦвета.ЗеленаяЛужайка, 124, 252, 0);
	ДобавитьЗапись(Таблица, WebЦвета.Лимонный, 255, 250, 205);
	ДобавитьЗапись(Таблица, WebЦвета.Голубой, 173, 216, 230);
	ДобавитьЗапись(Таблица, WebЦвета.СветлоКоралловый, 240, 128, 128);
	ДобавитьЗапись(Таблица, WebЦвета.ЦианСветлый, 224, 255, 255);
	ДобавитьЗапись(Таблица, WebЦвета.СветлоЗолотистый, 238, 221, 130);
	ДобавитьЗапись(Таблица, WebЦвета.СветлоЖелтыйЗолотистый, 250, 250, 210);
	ДобавитьЗапись(Таблица, WebЦвета.СветлоСерый, 211, 211, 211);
	ДобавитьЗапись(Таблица, WebЦвета.СветлоЗеленый, 144, 238, 144);
	ДобавитьЗапись(Таблица, WebЦвета.СветлоРозовый, 255, 182, 193);
	ДобавитьЗапись(Таблица, WebЦвета.ЛососьСветлый, 255, 160, 122);
	ДобавитьЗапись(Таблица, WebЦвета.ЦветМорскойВолныСветлый, 32, 178, 170);
	ДобавитьЗапись(Таблица, WebЦвета.СветлоНебесноГолубой, 135, 206, 250);
	ДобавитьЗапись(Таблица, WebЦвета.СветлоГрифельноСиний, 132, 112, 255);
	ДобавитьЗапись(Таблица, WebЦвета.СветлоГрифельноСерый, 119, 136, 153);
	ДобавитьЗапись(Таблица, WebЦвета.ГолубойСоСтальнымОттенком, 176, 196, 222);
	ДобавитьЗапись(Таблица, WebЦвета.СветлоЖелтый, 255, 255, 224);
	ДобавитьЗапись(Таблица, WebЦвета.ЗеленоватоЛимонный, 0, 255, 0);
	ДобавитьЗапись(Таблица, WebЦвета.ЛимонноЗеленый, 50, 205, 50);
	ДобавитьЗапись(Таблица, WebЦвета.Льняной, 250, 240, 230);
	ДобавитьЗапись(Таблица, WebЦвета.Фуксин, 255, 0, 255);
	ДобавитьЗапись(Таблица, WebЦвета.ТемноБордовый, 176, 48, 96);
	ДобавитьЗапись(Таблица, WebЦвета.НейтральноАквамариновый, 102, 205, 170);
	ДобавитьЗапись(Таблица, WebЦвета.НейтральноСиний, 0, 0, 205);
	ДобавитьЗапись(Таблица, WebЦвета.НейтральноСерый, 160, 160, 164);
	ДобавитьЗапись(Таблица, WebЦвета.НейтральноЗеленый, 192, 220, 192);
	ДобавитьЗапись(Таблица, WebЦвета.ОрхидеяНейтральный, 186, 85, 211);
	ДобавитьЗапись(Таблица, WebЦвета.НейтральноПурпурный, 147, 112, 219);
	ДобавитьЗапись(Таблица, WebЦвета.ЦветМорскойВолныНейтральный, 60, 179, 113);
	ДобавитьЗапись(Таблица, WebЦвета.НейтральноГрифельноСиний, 123, 104, 238);
	ДобавитьЗапись(Таблица, WebЦвета.НейтральноВесеннеЗеленый, 0, 250, 154);
	ДобавитьЗапись(Таблица, WebЦвета.НейтральноБирюзовый, 72, 209, 204);
	ДобавитьЗапись(Таблица, WebЦвета.НейтральноФиолетовоКрасный, 199, 21, 133);
	ДобавитьЗапись(Таблица, WebЦвета.ПолночноСиний, 25, 25, 112);
	ДобавитьЗапись(Таблица, WebЦвета.МятныйКрем, 245, 255, 250);
	ДобавитьЗапись(Таблица, WebЦвета.ТусклоРозовый, 255, 228, 225);
	ДобавитьЗапись(Таблица, WebЦвета.ЗамшаСветлый, 255, 228, 181);
	ДобавитьЗапись(Таблица, WebЦвета.НавахоБелый, 255, 222, 173);
	ДобавитьЗапись(Таблица, WebЦвета.Ультрамарин, 0, 0, 128);
	ДобавитьЗапись(Таблица, WebЦвета.СтароеКружево, 253, 245, 230);
	ДобавитьЗапись(Таблица, WebЦвета.Оливковый, 128, 128, 0);
	ДобавитьЗапись(Таблица, WebЦвета.ТусклоОливковый, 107, 142, 35);
	ДобавитьЗапись(Таблица, WebЦвета.Оранжевый, 255, 165, 0);
	ДобавитьЗапись(Таблица, WebЦвета.ОранжевоКрасный, 255, 69, 0);
	ДобавитьЗапись(Таблица, WebЦвета.Орхидея, 218, 112, 214);
	ДобавитьЗапись(Таблица, WebЦвета.БледноЗолотистый, 238, 232, 170);
	ДобавитьЗапись(Таблица, WebЦвета.БледноЗеленый, 152, 251, 152);
	ДобавитьЗапись(Таблица, WebЦвета.БледноБирюзовый, 175, 238, 238);
	ДобавитьЗапись(Таблица, WebЦвета.БледноКрасноФиолетовый, 219, 112, 147);
	ДобавитьЗапись(Таблица, WebЦвета.ТопленоеМолоко, 255, 239, 213);
	ДобавитьЗапись(Таблица, WebЦвета.Персиковый, 255, 218, 185);
	ДобавитьЗапись(Таблица, WebЦвета.НейтральноКоричневый, 205, 133, 63);
	ДобавитьЗапись(Таблица, WebЦвета.Розовый, 255, 192, 203);
	ДобавитьЗапись(Таблица, WebЦвета.Сливовый, 221, 160, 221);
	ДобавитьЗапись(Таблица, WebЦвета.СинийСПороховымОттенком, 176, 224, 230);
	ДобавитьЗапись(Таблица, WebЦвета.Пурпурный, 160, 32, 240);
	ДобавитьЗапись(Таблица, WebЦвета.Красный, 255, 0, 0);
	ДобавитьЗапись(Таблица, WebЦвета.РозовоКоричневый, 188, 143, 143);
	ДобавитьЗапись(Таблица, WebЦвета.КоролевскиГолубой, 65, 105, 225);
	ДобавитьЗапись(Таблица, WebЦвета.КожаноКоричневый, 139, 69, 19);
	ДобавитьЗапись(Таблица, WebЦвета.Лосось, 250, 128, 114);
	ДобавитьЗапись(Таблица, WebЦвета.ПесочноКоричневый, 244, 164, 96);
	ДобавитьЗапись(Таблица, WebЦвета.ЦветМорскойВолны, 46, 139, 87);
	ДобавитьЗапись(Таблица, WebЦвета.Перламутровый, 255, 245, 238);
	ДобавитьЗапись(Таблица, WebЦвета.Охра, 160, 82, 45);
	ДобавитьЗапись(Таблица, WebЦвета.Серебряный, 192, 192, 192);
	ДобавитьЗапись(Таблица, WebЦвета.НебесноГолубой, 135, 206, 235);
	ДобавитьЗапись(Таблица, WebЦвета.ГрифельноСиний, 106, 90, 205);
	ДобавитьЗапись(Таблица, WebЦвета.ГрифельноСерый, 112, 128, 144);
	ДобавитьЗапись(Таблица, WebЦвета.Белоснежный, 255, 250, 250);
	ДобавитьЗапись(Таблица, WebЦвета.ВесеннеЗеленый, 0, 255, 127);
	ДобавитьЗапись(Таблица, WebЦвета.СинийСоСтальнымОттенком, 70, 130, 180);
	ДобавитьЗапись(Таблица, WebЦвета.РыжеватоКоричневый, 210, 180, 140);
	ДобавитьЗапись(Таблица, WebЦвета.ЦианНейтральный, 0, 128, 128);
	ДобавитьЗапись(Таблица, WebЦвета.БледноСиреневый, 216, 191, 216);
	ДобавитьЗапись(Таблица, WebЦвета.Томатный, 255, 99, 71);
	ДобавитьЗапись(Таблица, WebЦвета.Бирюзовый, 64, 224, 208);
	ДобавитьЗапись(Таблица, WebЦвета.Фиолетовый, 238, 130, 238);
	ДобавитьЗапись(Таблица, WebЦвета.КрасноФиолетовый, 208, 32, 144);
	ДобавитьЗапись(Таблица, WebЦвета.Пшеничный, 245, 222, 179);
	ДобавитьЗапись(Таблица, WebЦвета.Белый, 255, 255, 255);
	ДобавитьЗапись(Таблица, WebЦвета.ДымчатоБелый, 245, 245, 245);
	ДобавитьЗапись(Таблица, WebЦвета.Желтый, 255, 255, 0);
	ДобавитьЗапись(Таблица, WebЦвета.ЖелтоЗеленый, 154, 205, 50);
	
	Таблица.Индексы.Добавить("ВебЦвет");
	
	Возврат Таблица;
	
КонецФункции

#КонецОбласти

#КонецОбласти

#Область СлужебныеПроцедурыИФункции

Процедура ДобавитьЗапись(Таблица, Значение1, Значение2, Значение3, Значение4)
	
	ОбщегоНазначенияУТ.ДобавитьЗапись(Таблица, Значение1, Значение2, Значение3, Значение4);
	
КонецПроцедуры

Функция КодЯзыкаКонфигурации()
	Если Метаданные.ВариантВстроенногоЯзыка = Метаданные.СвойстваОбъектов.ВариантВстроенногоЯзыка.Русский Тогда
		Язык = "Русский";
	Иначе
		Язык = "Английский";
	КонецЕсли;
	КодЯзыка = Метаданные.Языки[Язык].КодЯзыка;
	Возврат КодЯзыка;
КонецФункции

#КонецОбласти
