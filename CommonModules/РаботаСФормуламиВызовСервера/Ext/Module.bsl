
#Область ПрограммныйИнтерфейс

// Функция значение параметра по имени
//
// Параметры:
//   ТекстРасчета - Строка - вычисляемая формула
//   ЗначениеЗамены - Произвольный - параметр, для которого будет вычисляться формула.
//
// Возвращаемое значение:
//   Произвольный.
//
Функция ПроверитьФормулуЗапроса(ТекстРасчета, ЗначениеЗамены) Экспорт
	
	
	Запрос = Новый Запрос();
	Запрос.Текст = СтрЗаменить("ВЫБРАТЬ ПолеШаблон ИЗ ТаблицаШаблон","ПолеШаблон ИЗ ТаблицаШаблон",СтрЗаменить(ТекстРасчета, Строка(ЗначениеЗамены), "&Параметр"));
	Запрос.УстановитьПараметр("Параметр", ЗначениеЗамены);
	Выборка = Запрос.Выполнить().Выбрать();
	Выборка.Следующий();
	
	Возврат Выборка.Получить(0);
	
КонецФункции

// Процедура получения текста запроса
//
// Параметры:
//   ТекстРасчета   - Строка - вычисляемая формула
//   Операнды       - Массив - массив операндов
//   ЗначениеЗамены - Произвольный - параметр, для которого будет вычисляться формула.
//   ТипыОперандов - Соответствие - типы операндов
//
Процедура ПолучитьТекстРасчета(ТекстРасчета, Операнды, ЗначениеЗамены, ТипыОперандов = Неопределено) Экспорт
	
	ТипыОперандов = ?(ТипыОперандов = Неопределено, Новый Соответствие, ТипыОперандов);
	
	ГСЧ = Новый ГенераторСлучайныхЧисел();
	Для Каждого Операнд Из Операнды Цикл
		ЗначениеДляПодстановки = ЗначениеЗамены;
		Если ЗначениеЗамены = "1 " Тогда
			ТипОперанда = ТипыОперандов.Получить(Операнд);
			Если ТипОперанда <> Неопределено
					И ТипОперанда.СодержитТип(Тип("Дата")) Тогда
				ЗначениеДляПодстановки = "Дата(1,1,1)";
			Иначе
				СлучайноеЧисло = ГСЧ.СлучайноеЧисло(1, 1000);
				ЗначениеДляПодстановки = Строка(СлучайноеЧисло + " ");
			КонецЕсли;
		КонецЕсли;
		ТекстРасчета = СтрЗаменить(ТекстРасчета, РаботаСФормуламиКлиентСервер.ПолучитьТекстОперандаДляВставки(Операнд), ЗначениеДляПодстановки);
	КонецЦикла;

КонецПроцедуры

#КонецОбласти

