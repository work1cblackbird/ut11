
#Область ПрограммныйИнтерфейс

// См. ИнтеграцияShare.ОпубликоватьИПолучитьСсылкуНаСкачиваниеДокумента
//
Процедура ОпубликоватьИПолучитьСсылкуНаСкачиваниеДокумента(ПараметрыДокумента, Отказ) Экспорт
	
	ИнтеграцияShare.ОпубликоватьИПолучитьСсылкуНаСкачиваниеДокумента(ПараметрыДокумента, Отказ);
	
КонецПроцедуры

// Загружает данные документа по публичной ссылке из сервиса 1С:Share.
//
// Параметры:
//  СсылкаДляСкачивания           - Строка - адрес ссылки для скачивания документа.
//  ОписаниеЭлектронногоДокумента - См. НовоеКраткоеОписаниеЭлектронногоДокумента
//  Отказ                         - Булево - признак отказа выполнения. Подробности см. в журнале регистрации.
//
Процедура ЗагрузитьКраткиеДанныеДокументаПоПубличнойСсылке(СсылкаДляСкачивания, ОписаниеЭлектронногоДокумента, Отказ) Экспорт
	
	ОписаниеЭлектронногоДокумента = ИнтеграцияShare.КраткиеДанныеДокументаПоПубличнойСсылке(СсылкаДляСкачивания, Отказ);
	
КонецПроцедуры

#КонецОбласти

#Область СлужебныйПрограммныйИнтерфейс

Функция ДлительнаяОперацияВФоне(Знач НаименованиеЗадания, Знач ИмяПроцедуры, Знач УникальныйИдентификатор,
	Знач ДополнительныеПараметры) Экспорт
	
	ДоступныеПроцедуры = ДоступныеИменаПроцедур();
	Если ДоступныеПроцедуры.Найти(ИмяПроцедуры) = Неопределено Тогда
		ТекстОшибки = СтрШаблон(НСтр("ru = 'Вызвана недопустимая процедура в фоне ""%1""'", ОбщегоНазначения.КодОсновногоЯзыка()), ИмяПроцедуры);
		ТекстСообщения = НСтр("ru = 'Внутренняя ошибка выполнения операции.'", ОбщегоНазначения.КодОсновногоЯзыка());
		ЭлектронноеВзаимодействие.ОбработатьОшибку(НаименованиеЗадания, ТекстОшибки, ТекстСообщения);
		Возврат Неопределено;
	КонецЕсли;

	ПараметрыВыполнения = ДлительныеОперации.ПараметрыВыполненияВФоне(УникальныйИдентификатор);
	ПараметрыВыполнения.НаименованиеФоновогоЗадания = НаименованиеЗадания;
	ПараметрыВыполнения.ОжидатьЗавершение           = 0;
	ПараметрыВыполнения.ЗапуститьВФоне              = Истина;

	Возврат ДлительныеОперации.ВыполнитьВФоне(ИмяПроцедуры, ДополнительныеПараметры, ПараметрыВыполнения);

КонецФункции

// См. ИнтеграцияShare.ПараметрыОбъектаУчетаКПубликации
Функция ПараметрыОбъектаУчетаКПубликации(Знач ОбъектУчета) Экспорт
	
	Возврат ИнтеграцияShare.ПараметрыОбъектаУчетаКПубликации(ОбъектУчета);
	
КонецФункции

// См. ИнтеграцияShare.РезультатГлобальногоПоискаДокументаПоПубличнойССылке
Функция РезультатГлобальногоПоискаДокументаПоПубличнойССылке(Знач СсылкаДляСкачивания) Экспорт
	
	Возврат ИнтеграцияShare.РезультатГлобальногоПоискаДокументаПоПубличнойССылке(СсылкаДляСкачивания);
	
КонецФункции

#КонецОбласти

#Область СлужебныеПроцедурыИФункции

Функция ДоступныеИменаПроцедур()
	
	ИменаПроцедур = Новый Массив;
	ИменаПроцедур.Добавить(ИнтеграцияShareКлиентСервер.ИмяПроцедурыЗагрузитьЭлектронныйДокументПоИдентификаторуДокумента());
	ИменаПроцедур.Добавить(ИнтеграцияShareКлиентСервер.ИмяПроцедурыСоздатьВУчетеЭлектронныйДокумент());
	ИменаПроцедур.Добавить(ИнтеграцияShareКлиентСервер.ИмяПроцедурыОпубликоватьЭлектронныйДокумент());
	ИменаПроцедур.Добавить(ИнтеграцияShareКлиентСервер.ИмяПроцедурыЗагрузитьЭлектронныйДокументаПоПубличнойСсылкеИзСервиса());
	ИменаПроцедур.Добавить(ИнтеграцияShareКлиентСервер.ИмяПроцедурыЗагрузитьЭлектронныйДокументВОбъектУчета());
	
	Возврат ИменаПроцедур;

КонецФункции

#КонецОбласти