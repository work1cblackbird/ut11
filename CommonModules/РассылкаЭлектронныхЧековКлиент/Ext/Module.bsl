#Область ПрограммныйИнтерфейс

// Форма списка, в которой устанавливается отбор.
//
// Параметры:
//  ЭтотОбъект - Форма - Справочник.ОчередьЭлектронныхЧековКОтправке.ФормаСписка
//  Список - ДинамическийСписок
//
Процедура ПриОткрытииСпискаОчереди(ЭтотОбъект, Список) Экспорт
	
	Если ОбщегоНазначенияБПОКлиент.ИспользуетсяБСП() Тогда
		
		// Вызов БСП
		МодульОбщегоНазначенияКлиентСервер = ОбщегоНазначенияБПОКлиент.ОбщийМодуль("ОбщегоНазначенияКлиентСервер");
		МодульОбщегоНазначенияКлиентСервер.УстановитьЭлементОтбораДинамическогоСписка(
			Список, 
			"ПроизошлаОшибкаПередачи", 
			ЭтотОбъект.ОтборПоОшибкам,
			ВидСравненияКомпоновкиДанных.Равно,
			, 
			ЭтотОбъект.ОтборПоОшибкам);
		// Конец Вызов БСП
		
	КонецЕсли;
	
	РассылкаЭлектронныхЧековКлиентПереопределяемый.ПриОткрытииСпискаОчереди(ЭтотОбъект, Список);
	
КонецПроцедуры

#Область УстаревшиеПроцедурыИФункции

// Устарела: перенесена в модуль ОбщегоНазначенияБПОКлиент.ОбщийМодуль.
// Возвращает ссылку на общий модуль по имени.
//
// Параметры:
//  Имя          - Строка - имя общего модуля, например:
//                 "ОбщегоНазначения",
//                 "ОбщегоНазначенияКлиент".
//
// Возвращаемое значение:
//  ОбщийМодуль.
//
Функция ОбщийМодуль(Имя) Экспорт
	
	Возврат ОбщегоНазначенияБПОКлиент.ОбщийМодуль(Имя);
	
КонецФункции

// Устарела: следует использовать РассылкаЭлектронныхЧеков.ОтправитьЭлектронныйЧек.
// Процедура отправляет электронное сообщение на электронную почта и абонентский номер.
//
// Параметры:
//  ПараметрыЧека - Структура
//  ТекстСообщения - Строка - Текст письма или сообщения
//  ПокупательEmail - Строка - адрес электронной почты покупателя
//  ПокупательНомер - Строка - Номер телефона покупателя
//
Процедура НачатьОтправкуЭлектронногоЧека(ПараметрыЧека, ТекстСообщения, ПокупательEmail, ПокупательНомер) Экспорт
	
	РассылкаЭлектронныхЧековВызовСервера.НачатьОтправкуЭлектронногоЧека(ПараметрыЧека, ТекстСообщения, ПокупательEmail, ПокупательНомер);
	
КонецПроцедуры

// Устарела: больше не используется
// Процедура открывает форму настройки отправки электронных чеков
//
Процедура НастроитьОтправкуЭлектронныхЧеков() Экспорт
	
	РассылкаЭлектронныхЧековКлиентПереопределяемый.НастроитьОтправкуЭлектронныхЧеков();
	
КонецПроцедуры

#КонецОбласти

#КонецОбласти

