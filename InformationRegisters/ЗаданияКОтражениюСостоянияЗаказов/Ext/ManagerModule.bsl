#Если Сервер Или ТолстыйКлиентОбычноеПриложение Или ВнешнееСоединение Тогда

#Область ПрограммныйИнтерфейс

// Добавляет задания в регистр сведений "Задания к отражению состояния заказов".
// 
// Параметры:
//  Задания - ДокументСсылка, Массив из ДокументСсылка - документ или массив документов, которые надо отразит.
//  Действие - Строка - 
//  ТаблицаЗаданий - см. ОтложенныеЗадания.ДобавитьЗаданияВОчередь.ТаблицаЗаданий
//
Процедура ДобавитьЗадания(Задания, Действие = "", ТаблицаЗаданий = Неопределено) Экспорт
	
	Данные = Новый Структура("Документ, Действие");
	
	Если ТипЗнч(Задания) = Тип("Массив") Тогда
		
		Для каждого Задание Из Задания Цикл
			
			Данные.Документ = Задание;
			Данные.Действие = Действие;
			
			ОтложенныеЗадания.ДобавитьЗаданияВОчередь("ЗаданияКОтражениюСостоянияЗаказов", Данные,, ТаблицаЗаданий);
			
		КонецЦикла;
		
	Иначе
		
		Данные.Документ = Задания;
		Данные.Действие = Действие;
		
		ОтложенныеЗадания.ДобавитьЗаданияВОчередь("ЗаданияКОтражениюСостоянияЗаказов", Данные,, ТаблицаЗаданий);
		
	КонецЕсли;
	
КонецПроцедуры

#КонецОбласти

#КонецЕсли