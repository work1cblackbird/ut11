#Если Сервер Или ТолстыйКлиентОбычноеПриложение Или ВнешнееСоединение Тогда

#Область ПрограммныйИнтерфейс

// Записать состояние коммерческого предложения
//
// Параметры:
//  КоммерческоеПредложение - ДокументСсылка.КоммерческоеПредложениеКлиенту           - документ, состояние которого записывается,
//  Состояние               - ОпределяемыйТип.СостоянияКоммерческихПредложенийКлиенту - фиксируемое состояние документа.
//
Процедура ЗаписатьСостояние(КоммерческоеПредложение, Состояние) Экспорт
	
	Если Не ЗначениеЗаполнено(КоммерческоеПредложение) Тогда
		Возврат;
	КонецЕсли;
	
	НаборЗаписей = РегистрыСведений.СостоянияКоммерческихПредложенийКлиентам.СоздатьНаборЗаписей();
	
	НаборЗаписей.Отбор.КоммерческоеПредложениеКлиенту.Установить(КоммерческоеПредложение);
	
	Если ЗначениеЗаполнено(Состояние) Тогда
		
		Запись = НаборЗаписей.Добавить();
		Запись.КоммерческоеПредложениеКлиенту = КоммерческоеПредложение;
		Запись.Состояние                      = Состояние;
		
	КонецЕсли;
	
	НаборЗаписей.Записать();
	
КонецПроцедуры

#КонецОбласти

#КонецЕсли