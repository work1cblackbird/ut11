
#Область ОбработчикиСобытийФормы

&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	
	Если Параметры.Свойство("ПараметрКоманды") Тогда
		ОбъектСценариев = Параметры.ПараметрКоманды; 
	Иначе
		Отказ = Истина;
		Возврат;
	КонецЕсли;
	
	Если ТипЗнч(ОбъектСценариев) = Тип("СправочникСсылка.ПрофилиГруппДоступа") Тогда
		ОбъектДляСценариев = ОбъектСценариев; 
	ИначеЕсли ТипЗнч(ОбъектСценариев) = Тип("СправочникСсылка.ИдентификаторыОбъектовМетаданных") Тогда
		ОбъектДляСценариев = ОбъектСценариев;
	Иначе
		ОбъектДляСценариев = ОбщегоНазначения.ИдентификаторОбъектаМетаданных(ОбъектСценариев.Метаданные());
		Если Не ЗначениеЗаполнено(ОбъектДляСценариев) Тогда
			Отказ = Истина;
			Возврат;
		КонецЕсли;
	КонецЕсли;
	
	СформироватьОтчет();
	
КонецПроцедуры

#КонецОбласти 

#Область ОбработчикиКомандФормы

&НаКлиенте
Процедура Сформировать(Команда)
	
	СформироватьОтчет();
	
КонецПроцедуры

#КонецОбласти

#Область СлужебныеПроцедурыИФункции

&НаСервере
Процедура СформироватьОтчет()
	
	ТаблицаОтчета.Очистить();
	ОбъектОтчет =  РеквизитФормыВЗначение("Отчет");
		
	ОбъектОтчет.СформироватьОтчет(ТаблицаОтчета, ОбъектДляСценариев)
	
КонецПроцедуры

#КонецОбласти



