<?xml version="1.0" encoding="UTF-8"?>
<DataCompositionSchema xmlns="http://v8.1c.ru/8.1/data-composition-system/schema" xmlns:dcscom="http://v8.1c.ru/8.1/data-composition-system/common" xmlns:dcscor="http://v8.1c.ru/8.1/data-composition-system/core" xmlns:dcsset="http://v8.1c.ru/8.1/data-composition-system/settings" xmlns:v8="http://v8.1c.ru/8.1/data/core" xmlns:v8ui="http://v8.1c.ru/8.1/data/ui" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
	<dataSource>
		<name>ИсточникДанных1</name>
		<dataSourceType>Local</dataSourceType>
	</dataSource>
	<dataSet xsi:type="DataSetQuery">
		<name>Планы</name>
		<field xsi:type="DataSetFieldField">
			<dataPath>Номенклатура</dataPath>
			<field>Номенклатура</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Номенклатура</v8:content>
				</v8:item>
			</title>
			<role>
				<dcscom:dimension>true</dcscom:dimension>
			</role>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>СегментНоменклатуры</dataPath>
			<field>СегментНоменклатуры</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Сегмент номенклатуры</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Соглашение</dataPath>
			<field>Соглашение</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Соглашение</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Поставщик</dataPath>
			<field>Поставщик</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Поставщик</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ДатаЗаказа</dataPath>
			<field>ДатаЗаказа</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Дата заказа</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ДнейДоЗаказа</dataPath>
			<field>ДнейДоЗаказа</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Дней до заказа</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Артикул</dataPath>
			<field>Артикул</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Вес</dataPath>
			<field>Вес</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Вес</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ДатаПоступления</dataPath>
			<field>ДатаПоступления</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Дата поступления</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>КоличествоВЗаказах</dataPath>
			<field>КоличествоВЗаказах</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Количество в заказах</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>КоличествоВПланах</dataPath>
			<field>КоличествоВПланах</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Количество в планах</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Партнер</dataPath>
			<field>Партнер</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Партнер</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Характеристика</dataPath>
			<field>Характеристика</field>
			<role>
				<dcscom:dimension>true</dcscom:dimension>
			</role>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ХарактеристикиИспользуются</dataPath>
			<field>ХарактеристикиИспользуются</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Характеристики используются</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Сценарий</dataPath>
			<field>Сценарий</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Подразделение</dataPath>
			<field>Подразделение</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Подразделение</v8:content>
				</v8:item>
			</title>
			<role>
				<dcscom:dimension>true</dcscom:dimension>
			</role>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Склад</dataPath>
			<field>Склад</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Склад</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ТипНоменклатуры</dataPath>
			<field>ТипНоменклатуры</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Валюта</dataPath>
			<field>Валюта</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Валюта</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Организация</dataPath>
			<field>Организация</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Цена</dataPath>
			<field>Цена</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Цена</v8:content>
				</v8:item>
			</title>
			<valueType>
				<v8:TypeId>48fa9d68-ae46-4d76-988a-88927f7a0ca6</v8:TypeId>
			</valueType>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ПланЗакупок</dataPath>
			<field>ПланЗакупок</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>КоличествоУпаковок</dataPath>
			<field>КоличествоУпаковок</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Количество упаковок</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ОбщийВес</dataPath>
			<field>ОбщийВес</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Общий вес</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Количество</dataPath>
			<field>Количество</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Количество</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Код</dataPath>
			<field>Код</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ПоставщикВПлане</dataPath>
			<field>ПоставщикВПлане</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Поставщик в плане</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>СкладВПлане</dataPath>
			<field>СкладВПлане</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Склад в плане</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>СоглашениеВПлане</dataPath>
			<field>СоглашениеВПлане</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Соглашение в плане</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Статус</dataPath>
			<field>Статус</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ОкончаниеПериодаПоступления</dataPath>
			<field>ОкончаниеПериодаПоступления</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Окончание периода поступления</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>РедактироватьПодразделение</dataPath>
			<field>РедактироватьПодразделение</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Редактировать подразделение</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Назначение</dataPath>
			<field>Назначение</field>
			<role>
				<dcscom:dimension>true</dcscom:dimension>
			</role>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>НаправлениеДеятельности</dataPath>
			<field>НаправлениеДеятельности</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Направление деятельности</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ВидПлана</dataPath>
			<field>ВидПлана</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>ВидЦеныПоставщика</dataPath>
			<field>ВидЦеныПоставщика</field>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>РедактироватьСклад</dataPath>
			<field>РедактироватьСклад</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Редактировать склад</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>РедактироватьСоглашение</dataPath>
			<field>РедактироватьСоглашение</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Редактировать соглашение</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>РедактироватьПартнер</dataPath>
			<field>РедактироватьПартнер</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Редактировать партнер</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>Упаковка</dataPath>
			<field>Упаковка</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Упаковка</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>МинимальнаяПартияПоставки</dataPath>
			<field>МинимальнаяПартияПоставки</field>
			<title xsi:type="v8:LocalStringType">
				<v8:item>
					<v8:lang>ru</v8:lang>
					<v8:content>Минимальная партия поставки</v8:content>
				</v8:item>
			</title>
		</field>
		<field xsi:type="DataSetFieldField">
			<dataPath>БазоваяВалюта</dataPath>
			<field>БазоваяВалюта</field>
		</field>
		<dataSource>ИсточникДанных1</dataSource>
		<query>ВЫБРАТЬ РАЗРЕШЕННЫЕ
	НоменклатураСегмента.Номенклатура КАК Номенклатура,
	НоменклатураСегмента.Характеристика КАК Характеристика,
	ИСТИНА КАК ИспользуетсяОтборПоСегментуНоменклатуры
ПОМЕСТИТЬ ОтборПоСегментуНоменклатуры
ИЗ
	РегистрСведений.НоменклатураСегмента КАК НоменклатураСегмента
{ГДЕ
	НоменклатураСегмента.Сегмент.* КАК СегментНоменклатуры,
	НоменклатураСегмента.Номенклатура.*,
	НоменклатураСегмента.Характеристика.*}

ИНДЕКСИРОВАТЬ ПО
	Номенклатура,
	Характеристика
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	ВЫБОР &amp;Периодичность
		КОГДА ЗНАЧЕНИЕ(Перечисление.Периодичность.Неделя)
			ТОГДА КОНЕЦПЕРИОДА(ПланыЗакупокОбороты.ПериодНеделя, НЕДЕЛЯ)
		КОГДА ЗНАЧЕНИЕ(Перечисление.Периодичность.Декада)
			ТОГДА КОНЕЦПЕРИОДА(ПланыЗакупокОбороты.ПериодДекада, ДЕКАДА)
		КОГДА ЗНАЧЕНИЕ(Перечисление.Периодичность.Месяц)
			ТОГДА КОНЕЦПЕРИОДА(ПланыЗакупокОбороты.ПериодМесяц, МЕСЯЦ)
		КОГДА ЗНАЧЕНИЕ(Перечисление.Периодичность.Квартал)
			ТОГДА КОНЕЦПЕРИОДА(ПланыЗакупокОбороты.ПериодКвартал, КВАРТАЛ)
		КОГДА ЗНАЧЕНИЕ(Перечисление.Периодичность.Полугодие)
			ТОГДА КОНЕЦПЕРИОДА(ПланыЗакупокОбороты.ПериодПолугодие, ПОЛУГОДИЕ)
		КОГДА ЗНАЧЕНИЕ(Перечисление.Периодичность.Год)
			ТОГДА КОНЕЦПЕРИОДА(ПланыЗакупокОбороты.ПериодГод, ГОД)
		ИНАЧЕ КОНЕЦПЕРИОДА(ПланыЗакупокОбороты.ПериодДень, ДЕНЬ)
	КОНЕЦ КАК ОкончаниеПериодаПоступления,
	ВЫБОР &amp;Периодичность
		КОГДА ЗНАЧЕНИЕ(Перечисление.Периодичность.Неделя)
			ТОГДА ПланыЗакупокОбороты.ПериодНеделя
		КОГДА ЗНАЧЕНИЕ(Перечисление.Периодичность.Декада)
			ТОГДА ПланыЗакупокОбороты.ПериодДекада
		КОГДА ЗНАЧЕНИЕ(Перечисление.Периодичность.Месяц)
			ТОГДА ПланыЗакупокОбороты.ПериодМесяц
		КОГДА ЗНАЧЕНИЕ(Перечисление.Периодичность.Квартал)
			ТОГДА ПланыЗакупокОбороты.ПериодКвартал
		КОГДА ЗНАЧЕНИЕ(Перечисление.Периодичность.Полугодие)
			ТОГДА ПланыЗакупокОбороты.ПериодПолугодие
		КОГДА ЗНАЧЕНИЕ(Перечисление.Периодичность.Год)
			ТОГДА ПланыЗакупокОбороты.ПериодГод
		ИНАЧЕ ПланыЗакупокОбороты.ПериодДень
	КОНЕЦ КАК ДатаПоступления,
	ПланыЗакупокОбороты.ДатаЗаказа КАК ДатаЗаказа,
	ПланыЗакупокОбороты.Подразделение КАК Подразделение,
	ВЫБОР
		КОГДА ПланыЗакупокОбороты.Партнер = ЗНАЧЕНИЕ(Справочник.Партнеры.ПустаяСсылка)
			ТОГДА ЕСТЬNULL(ВЫРАЗИТЬ(Способы.ИсточникОбеспеченияПотребностей КАК Справочник.Партнеры), ЗНАЧЕНИЕ(Справочник.Партнеры.ПустаяСсылка))
		ИНАЧЕ ПланыЗакупокОбороты.Партнер
	КОНЕЦ КАК Партнер,
	ВЫБОР
		КОГДА ПланыЗакупокОбороты.Соглашение = ЗНАЧЕНИЕ(Справочник.СоглашенияСПоставщиками.ПустаяСсылка)
			ТОГДА ЕСТЬNULL(Способы.Соглашение, ЗНАЧЕНИЕ(Справочник.СоглашенияСПоставщиками.ПустаяСсылка))
		ИНАЧЕ ПланыЗакупокОбороты.Соглашение
	КОНЕЦ КАК Соглашение,
	ПланыЗакупокОбороты.Партнер КАК ПартнерПлан,
	ПланыЗакупокОбороты.Соглашение КАК СоглашениеПлан,
	ПланыЗакупокОбороты.Номенклатура КАК Номенклатура,
	ПланыЗакупокОбороты.Характеристика КАК Характеристика,
	ПланыЗакупокОбороты.Назначение КАК Назначение,
	ПланыЗакупокОбороты.Склад КАК Склад,
	СУММА(ПланыЗакупокОбороты.КЗаказуОборот) КАК КоличествоВПланах,
	ВЫБОР
		КОГДА ПланыЗакупокОбороты.КЗаказуОборот = 0
			ТОГДА 0
		ИНАЧЕ ВЫРАЗИТЬ(ПланыЗакупокОбороты.СуммаОборот / ПланыЗакупокОбороты.КЗаказуОборот КАК ЧИСЛО(31, 2))
	КОНЕЦ КАК ЦенаПлан,
	ЕСТЬNULL(Способы.СрокИсполненияЗаказа, 0) КАК ДнейДоЗаказа,
	ВЫБОР
		КОГДА ЕСТЬNULL(Склады.Календарь, ЗНАЧЕНИЕ(Справочник.Календари.ПустаяСсылка)) = ЗНАЧЕНИЕ(Справочник.Календари.ПустаяСсылка)
			ТОГДА ОсновнойКалендарьПредприятия.Значение
		ИНАЧЕ ЕСТЬNULL(Склады.Календарь, ЗНАЧЕНИЕ(Справочник.Календари.ПустаяСсылка))
	КОНЕЦ КАК Календарь
ПОМЕСТИТЬ ТаблицаПланов
ИЗ
	РегистрНакопления.ПланыЗакупок.Обороты(
			&amp;НачалоПериода,
			&amp;ОкончаниеПериода,
			Авто,
			Сценарий = &amp;Сценарий
				И Статус = ЗНАЧЕНИЕ(Перечисление.СтатусыПланов.Утвержден)
				И (НЕ &amp;ОтборПоНазначению
					ИЛИ Назначение = &amp;Назначение) {(Номенклатура).* КАК Номенклатура, (Партнер).* КАК ПоставщикВПлане, (Соглашение).* КАК СоглашениеВПлане, (Склад).* КАК СкладВПлане, ((Номенклатура, Характеристика) В
			    (ВЫБРАТЬ
			        ОтборПоСегментуНоменклатуры.Номенклатура,
			        ОтборПоСегментуНоменклатуры.Характеристика
			    ИЗ
			        ОтборПоСегментуНоменклатуры
			    ГДЕ
			        ОтборПоСегментуНоменклатуры.ИспользуетсяОтборПоСегментуНоменклатуры = &amp;ИспользуетсяОтборПоСегментуНоменклатуры))}) КАК ПланыЗакупокОбороты
		ЛЕВОЕ СОЕДИНЕНИЕ Справочник.СпособыОбеспеченияПотребностей КАК Способы
		ПО &amp;ПодстановкаОсновногоСпособаОбеспечения
			И (Способы.ТипОбеспечения = ЗНАЧЕНИЕ(Перечисление.ТипыОбеспечения.Покупка))
			И (ВЫБОР
				КОГДА ПланыЗакупокОбороты.Партнер = ЗНАЧЕНИЕ(Справочник.Партнеры.ПустаяСсылка)
					ТОГДА ИСТИНА
				КОГДА ПланыЗакупокОбороты.Соглашение = ЗНАЧЕНИЕ(Справочник.СоглашенияСПоставщиками.ПустаяСсылка)
					ТОГДА ПланыЗакупокОбороты.Партнер = Способы.ИсточникОбеспеченияПотребностей
				ИНАЧЕ ПланыЗакупокОбороты.Партнер = Способы.ИсточникОбеспеченияПотребностей
						И ПланыЗакупокОбороты.Соглашение = Способы.Соглашение
			КОНЕЦ)
		ЛЕВОЕ СОЕДИНЕНИЕ Справочник.Склады КАК Склады
		ПО ПланыЗакупокОбороты.Склад = Склады.Ссылка,
	Константа.ОсновнойКалендарьПредприятия КАК ОсновнойКалендарьПредприятия

СГРУППИРОВАТЬ ПО
	ВЫБОР
		КОГДА ПланыЗакупокОбороты.КЗаказуОборот = 0
			ТОГДА 0
		ИНАЧЕ ВЫРАЗИТЬ(ПланыЗакупокОбороты.СуммаОборот / ПланыЗакупокОбороты.КЗаказуОборот КАК ЧИСЛО(31, 2))
	КОНЕЦ,
	ВЫБОР &amp;Периодичность
		КОГДА ЗНАЧЕНИЕ(Перечисление.Периодичность.Неделя)
			ТОГДА КОНЕЦПЕРИОДА(ПланыЗакупокОбороты.ПериодНеделя, НЕДЕЛЯ)
		КОГДА ЗНАЧЕНИЕ(Перечисление.Периодичность.Декада)
			ТОГДА КОНЕЦПЕРИОДА(ПланыЗакупокОбороты.ПериодДекада, ДЕКАДА)
		КОГДА ЗНАЧЕНИЕ(Перечисление.Периодичность.Месяц)
			ТОГДА КОНЕЦПЕРИОДА(ПланыЗакупокОбороты.ПериодМесяц, МЕСЯЦ)
		КОГДА ЗНАЧЕНИЕ(Перечисление.Периодичность.Квартал)
			ТОГДА КОНЕЦПЕРИОДА(ПланыЗакупокОбороты.ПериодКвартал, КВАРТАЛ)
		КОГДА ЗНАЧЕНИЕ(Перечисление.Периодичность.Полугодие)
			ТОГДА КОНЕЦПЕРИОДА(ПланыЗакупокОбороты.ПериодПолугодие, ПОЛУГОДИЕ)
		КОГДА ЗНАЧЕНИЕ(Перечисление.Периодичность.Год)
			ТОГДА КОНЕЦПЕРИОДА(ПланыЗакупокОбороты.ПериодГод, ГОД)
		ИНАЧЕ КОНЕЦПЕРИОДА(ПланыЗакупокОбороты.ПериодДень, ДЕНЬ)
	КОНЕЦ,
	ПланыЗакупокОбороты.ДатаЗаказа,
	ВЫБОР
		КОГДА ПланыЗакупокОбороты.Партнер = ЗНАЧЕНИЕ(Справочник.Партнеры.ПустаяСсылка)
			ТОГДА ЕСТЬNULL(ВЫРАЗИТЬ(Способы.ИсточникОбеспеченияПотребностей КАК Справочник.Партнеры), ЗНАЧЕНИЕ(Справочник.Партнеры.ПустаяСсылка))
		ИНАЧЕ ПланыЗакупокОбороты.Партнер
	КОНЕЦ,
	ПланыЗакупокОбороты.Соглашение,
	ВЫБОР &amp;Периодичность
		КОГДА ЗНАЧЕНИЕ(Перечисление.Периодичность.Неделя)
			ТОГДА ПланыЗакупокОбороты.ПериодНеделя
		КОГДА ЗНАЧЕНИЕ(Перечисление.Периодичность.Декада)
			ТОГДА ПланыЗакупокОбороты.ПериодДекада
		КОГДА ЗНАЧЕНИЕ(Перечисление.Периодичность.Месяц)
			ТОГДА ПланыЗакупокОбороты.ПериодМесяц
		КОГДА ЗНАЧЕНИЕ(Перечисление.Периодичность.Квартал)
			ТОГДА ПланыЗакупокОбороты.ПериодКвартал
		КОГДА ЗНАЧЕНИЕ(Перечисление.Периодичность.Полугодие)
			ТОГДА ПланыЗакупокОбороты.ПериодПолугодие
		КОГДА ЗНАЧЕНИЕ(Перечисление.Периодичность.Год)
			ТОГДА ПланыЗакупокОбороты.ПериодГод
		ИНАЧЕ ПланыЗакупокОбороты.ПериодДень
	КОНЕЦ,
	ВЫБОР
		КОГДА ПланыЗакупокОбороты.Соглашение = ЗНАЧЕНИЕ(Справочник.СоглашенияСПоставщиками.ПустаяСсылка)
			ТОГДА ЕСТЬNULL(Способы.Соглашение, ЗНАЧЕНИЕ(Справочник.СоглашенияСПоставщиками.ПустаяСсылка))
		ИНАЧЕ ПланыЗакупокОбороты.Соглашение
	КОНЕЦ,
	ПланыЗакупокОбороты.Подразделение,
	ПланыЗакупокОбороты.Номенклатура,
	ПланыЗакупокОбороты.Характеристика,
	ПланыЗакупокОбороты.Назначение,
	ПланыЗакупокОбороты.Склад,
	ПланыЗакупокОбороты.Партнер,
	ВЫБОР
		КОГДА ЕСТЬNULL(Склады.Календарь, ЗНАЧЕНИЕ(Справочник.Календари.ПустаяСсылка)) = ЗНАЧЕНИЕ(Справочник.Календари.ПустаяСсылка)
			ТОГДА ОсновнойКалендарьПредприятия.Значение
		ИНАЧЕ ЕСТЬNULL(Склады.Календарь, ЗНАЧЕНИЕ(Справочник.Календари.ПустаяСсылка))
	КОНЕЦ,
	ЕСТЬNULL(Способы.СрокИсполненияЗаказа, 0)

ИНДЕКСИРОВАТЬ ПО
	ДатаПоступления,
	Номенклатура,
	Характеристика,
	Назначение,
	Склад,
	ПартнерПлан,
	СоглашениеПлан,
	Подразделение
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ТаблицаПланов.ОкончаниеПериодаПоступления КАК ОкончаниеПериодаПоступления,
	ТаблицаПланов.ДатаПоступления КАК ДатаПоступления,
	ТаблицаПланов.ДатаЗаказа КАК ДатаЗаказа,
	ТаблицаПланов.Подразделение КАК Подразделение,
	ТаблицаПланов.Партнер КАК Партнер,
	ТаблицаПланов.Соглашение КАК Соглашение,
	ТаблицаПланов.Номенклатура КАК Номенклатура,
	ТаблицаПланов.Характеристика КАК Характеристика,
	ТаблицаПланов.Назначение КАК Назначение,
	ТаблицаПланов.Склад КАК Склад,
	МАКСИМУМ(ТаблицаПланов.КоличествоВПланах) КАК КоличествоВПланах,
	ТаблицаПланов.ЦенаПлан КАК ЦенаПлан,
	МАКСИМУМ(ТаблицаПланов.ДнейДоЗаказа) КАК ДнейДоЗаказа,
	ТаблицаПланов.Календарь КАК Календарь,
	ЕСТЬNULL(СУММА(ЗаказПоставщикуТовары.Количество), 0) КАК КоличествоВЗаказах
ПОМЕСТИТЬ ТаблицаПланыЗаказы
ИЗ
	ТаблицаПланов КАК ТаблицаПланов
		ЛЕВОЕ СОЕДИНЕНИЕ Документ.ЗаказПоставщику.Товары КАК ЗаказПоставщикуТовары
		ПО (ЗаказПоставщикуТовары.ДатаПоступления МЕЖДУ ТаблицаПланов.ДатаПоступления И ТаблицаПланов.ОкончаниеПериодаПоступления)
			И ТаблицаПланов.Номенклатура = ЗаказПоставщикуТовары.Номенклатура
			И (ЗаказПоставщикуТовары.Ссылка.Проведен)
			И (НЕ ЗаказПоставщикуТовары.Отменено)
			И ТаблицаПланов.Характеристика = ЗаказПоставщикуТовары.Характеристика
			И (ВЫБОР
				КОГДА ТаблицаПланов.Склад = ЗНАЧЕНИЕ(Справочник.Склады.ПустаяСсылка)
					ТОГДА ИСТИНА
				ИНАЧЕ ТаблицаПланов.Склад = ЗаказПоставщикуТовары.Склад
			КОНЕЦ)
			И (ВЫБОР
				КОГДА НЕ &amp;ПланированиеПоНазначениям
					ТОГДА ИСТИНА
				ИНАЧЕ ТаблицаПланов.Назначение = ЗаказПоставщикуТовары.Назначение
			КОНЕЦ)
			И (ВЫБОР
				КОГДА ТаблицаПланов.Подразделение = ЗНАЧЕНИЕ(Справочник.СтруктураПредприятия.ПустаяСсылка)
					ТОГДА ИСТИНА
				ИНАЧЕ ТаблицаПланов.Подразделение = ЗаказПоставщикуТовары.Ссылка.Подразделение
			КОНЕЦ)
			И (ВЫБОР
				КОГДА ТаблицаПланов.ПартнерПлан = ЗНАЧЕНИЕ(Справочник.Партнеры.ПустаяСсылка)
					ТОГДА ИСТИНА
				ИНАЧЕ ТаблицаПланов.ПартнерПлан = ЗаказПоставщикуТовары.Ссылка.Партнер
			КОНЕЦ)
			И (ВЫБОР
				КОГДА ТаблицаПланов.СоглашениеПлан = ЗНАЧЕНИЕ(Справочник.СоглашенияСПоставщиками.ПустаяСсылка)
					ТОГДА ИСТИНА
				ИНАЧЕ ТаблицаПланов.Соглашение = ЗаказПоставщикуТовары.Ссылка.Соглашение
			КОНЕЦ)

СГРУППИРОВАТЬ ПО
	ТаблицаПланов.Партнер,
	ТаблицаПланов.Номенклатура,
	ТаблицаПланов.Склад,
	ТаблицаПланов.ДатаПоступления,
	ТаблицаПланов.ДатаЗаказа,
	ТаблицаПланов.Календарь,
	ТаблицаПланов.Соглашение,
	ТаблицаПланов.ОкончаниеПериодаПоступления,
	ТаблицаПланов.Характеристика,
	ТаблицаПланов.Назначение,
	ТаблицаПланов.Подразделение,
	ТаблицаПланов.ЦенаПлан
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ ТаблицаПланов
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	ТаблицаПланов.Партнер КАК Партнер,
	МАКСИМУМ(СоглашенияСПоставщиками.Ссылка) КАК Соглашение
ПОМЕСТИТЬ СоглашенияПоУмолчанию
ИЗ
	ТаблицаПланыЗаказы КАК ТаблицаПланов
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Справочник.СоглашенияСПоставщиками КАК СоглашенияСПоставщиками
		ПО ТаблицаПланов.Партнер = СоглашенияСПоставщиками.Партнер
			И (НЕ СоглашенияСПоставщиками.ПометкаУдаления)
			И (СоглашенияСПоставщиками.Статус = ЗНАЧЕНИЕ(Перечисление.СтатусыСоглашенийСПоставщиками.Действует))
ГДЕ
	ТаблицаПланов.Соглашение = ЗНАЧЕНИЕ(Справочник.СоглашенияСПоставщиками.ПустаяСсылка)
	И ТаблицаПланов.Партнер &lt;&gt; ЗНАЧЕНИЕ(Справочник.Партнеры.ПустаяСсылка)

СГРУППИРОВАТЬ ПО
	ТаблицаПланов.Партнер

ИМЕЮЩИЕ
	СУММА(1) = 1

ИНДЕКСИРОВАТЬ ПО
	Партнер
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ТаблицаПланов.Календарь КАК Календарь,
	КалендарныеГрафики.Год КАК Год,
	МАКСИМУМ(КалендарныеГрафики.КоличествоДнейВГрафикеСНачалаГода) КАК КоличествоДнейВГрафикеСНачалаГода
ПОМЕСТИТЬ ГрафикиКоличествоДнейВПрошломГоду
ИЗ
	ТаблицаПланыЗаказы КАК ТаблицаПланов
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.КалендарныеГрафики КАК КалендарныеГрафики
		ПО ТаблицаПланов.Календарь = КалендарныеГрафики.Календарь
			И (ГОД(ТаблицаПланов.ДатаПоступления) - 1 = КалендарныеГрафики.Год)
ГДЕ
	КалендарныеГрафики.Год &gt; 0

СГРУППИРОВАТЬ ПО
	ТаблицаПланов.Календарь,
	КалендарныеГрафики.Год

ИНДЕКСИРОВАТЬ ПО
	Календарь,
	Год,
	КоличествоДнейВГрафикеСНачалаГода
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ТаблицаПланов.ОкончаниеПериодаПоступления КАК ОкончаниеПериодаПоступления,
	ТаблицаПланов.ДатаПоступления КАК ДатаПоступления,
	ТаблицаПланов.Подразделение КАК Подразделение,
	ТаблицаПланов.Партнер КАК Партнер,
	ВЫБОР
		КОГДА ТаблицаПланов.Соглашение = ЗНАЧЕНИЕ(Справочник.СоглашенияСПоставщиками.ПустаяСсылка)
			ТОГДА ЕСТЬNULL(СоглашенияПоУмолчанию.Соглашение, ЗНАЧЕНИЕ(Справочник.СоглашенияСПоставщиками.ПустаяСсылка))
		ИНАЧЕ ТаблицаПланов.Соглашение
	КОНЕЦ КАК Соглашение,
	ТаблицаПланов.Номенклатура КАК Номенклатура,
	ТаблицаПланов.Характеристика КАК Характеристика,
	ТаблицаПланов.Назначение КАК Назначение,
	ТаблицаПланов.Склад КАК Склад,
	ТаблицаПланов.КоличествоВПланах КАК КоличествоВПланах,
	ТаблицаПланов.ЦенаПлан КАК ЦенаПлан,
	ТаблицаПланов.КоличествоВЗаказах КАК КоличествоВЗаказах,
	ВЫБОР
		КОГДА ТаблицаПланов.ДатаЗаказа ЕСТЬ NULL
			ТОГДА ДОБАВИТЬКДАТЕ(ТаблицаПланов.ДатаПоступления, ДЕНЬ, -ТаблицаПланов.ДнейДоЗаказа)
		ИНАЧЕ ТаблицаПланов.ДатаЗаказа
	КОНЕЦ КАК ДатаЗаказа,
	ТаблицаПланов.ДнейДоЗаказа КАК ДнейДоЗаказа
ПОМЕСТИТЬ ТаблицаПлановСДатамиЗаказа
ИЗ
	ТаблицаПланыЗаказы КАК ТаблицаПланов
		ЛЕВОЕ СОЕДИНЕНИЕ СоглашенияПоУмолчанию КАК СоглашенияПоУмолчанию
		ПО ТаблицаПланов.Партнер = СоглашенияПоУмолчанию.Партнер
			И (ТаблицаПланов.Соглашение = ЗНАЧЕНИЕ(Справочник.СоглашенияСПоставщиками.ПустаяСсылка))
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.КалендарныеГрафики КАК ГрафикДатаПоступления
		ПО ТаблицаПланов.Календарь = ГрафикДатаПоступления.Календарь
			И (ГОД(ТаблицаПланов.ДатаПоступления) = ГрафикДатаПоступления.Год)
			И ТаблицаПланов.ДатаПоступления = ГрафикДатаПоступления.ДатаГрафика
		ЛЕВОЕ СОЕДИНЕНИЕ ГрафикиКоличествоДнейВПрошломГоду КАК ГрафикиПрошлыйГод
		ПО ТаблицаПланов.Календарь = ГрафикиПрошлыйГод.Календарь
			И (ГОД(ТаблицаПланов.ДатаПоступления) - 1 = ГрафикиПрошлыйГод.Год)
			И (ВЫБОР
				КОГДА НЕ ГрафикДатаПоступления.ДатаГрафика ЕСТЬ NULL
						И (ЕСТЬNULL(ГрафикДатаПоступления.КоличествоДнейВГрафикеСНачалаГода, 0) &lt; ТаблицаПланов.ДнейДоЗаказа
							ИЛИ ЕСТЬNULL(ГрафикДатаПоступления.КоличествоДнейВГрафикеСНачалаГода, 0) = 0)
					ТОГДА ИСТИНА
				ИНАЧЕ ЛОЖЬ
			КОНЕЦ)
ГДЕ
	ВЫБОР
			КОГДА &amp;ДатаНачалаЗаказа = ДАТАВРЕМЯ(1, 1, 1)
				ТОГДА ИСТИНА
			ИНАЧЕ ТаблицаПланов.ДатаЗаказа &gt;= &amp;ДатаНачалаЗаказа
		КОНЕЦ
	И ВЫБОР
			КОГДА &amp;ДатаОкончанияЗаказа = ДАТАВРЕМЯ(1, 1, 1)
				ТОГДА ИСТИНА
			ИНАЧЕ ТаблицаПланов.ДатаЗаказа &lt;= &amp;ДатаОкончанияЗаказа
		КОНЕЦ
{ГДЕ
	ТаблицаПланов.Партнер.* КАК Поставщик,
	ТаблицаПланов.Склад.* КАК Склад}

ИНДЕКСИРОВАТЬ ПО
	Соглашение,
	Номенклатура,
	Характеристика,
	Назначение
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ ТаблицаПланыЗаказы
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ СоглашенияПоУмолчанию
;

////////////////////////////////////////////////////////////////////////////////
УНИЧТОЖИТЬ ГрафикиКоличествоДнейВПрошломГоду
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	УсловияЗакупокСрезПоследних.Номенклатура КАК Номенклатура,
	УсловияЗакупокСрезПоследних.Характеристика КАК Характеристика,
	УсловияЗакупокСрезПоследних.ВидЦеныПоставщика КАК ВидЦеныПоставщика,
	УсловияЗакупокСрезПоследних.УпаковкаЗаказа КАК Упаковка,
	УсловияЗакупокСрезПоследних.МинимальнаяПартияПоставки КАК МинимальнаяПартияПоставки
ПОМЕСТИТЬ УсловияЗакупок
ИЗ
	РегистрСведений.УсловияЗакупок.СрезПоследних(
			&amp;ТекущаяДата,
			(Номенклатура, Характеристика) В
				(ВЫБРАТЬ РАЗЛИЧНЫЕ
					ТаблицаПланов.Номенклатура,
					ТаблицаПланов.Характеристика
				ИЗ
					ТаблицаПлановСДатамиЗаказа КАК ТаблицаПланов)) КАК УсловияЗакупокСрезПоследних

ИНДЕКСИРОВАТЬ ПО
	Номенклатура,
	Характеристика,
	ВидЦеныПоставщика
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ РАЗРЕШЕННЫЕ
	ТаблицаПланов.Подразделение КАК Подразделение,
	ТаблицаПланов.Партнер КАК Партнер,
	ТаблицаПланов.Соглашение КАК Соглашение,
	ТаблицаПланов.Номенклатура КАК Номенклатура,
	ТаблицаПланов.Характеристика КАК Характеристика,
	ТаблицаПланов.Назначение КАК Назначение,
	ВЫБОР
		КОГДА ТаблицаПланов.Склад = ЗНАЧЕНИЕ(Справочник.Склады.ПустаяСсылка)
			ТОГДА ЕСТЬNULL(СоглашенияСПоставщиками.Склад, ЗНАЧЕНИЕ(Справочник.Склады.ПустаяСсылка))
		ИНАЧЕ ТаблицаПланов.Склад
	КОНЕЦ КАК Склад,
	СпрНоменклатура.Код КАК Код,
	СпрНоменклатура.Артикул КАК Артикул,
	ТаблицаПланов.ДатаПоступления КАК ДатаПоступления,
	ТаблицаПланов.ОкончаниеПериодаПоступления КАК ОкончаниеПериодаПоступления,
	ТаблицаПланов.КоличествоВПланах КАК КоличествоВПланах,
	ТаблицаПланов.КоличествоВЗаказах КАК КоличествоВЗаказах,
	ТаблицаПланов.КоличествоВПланах - ТаблицаПланов.КоличествоВЗаказах КАК КоличествоУпаковок,
	ТаблицаПланов.КоличествоВПланах - ТаблицаПланов.КоличествоВЗаказах КАК Количество,
	ВЫБОР
		КОГДА СпрНоменклатура.ИспользованиеХарактеристик = ЗНАЧЕНИЕ(Перечисление.ВариантыИспользованияХарактеристикНоменклатуры.ОбщиеДляВидаНоменклатуры)
				ИЛИ СпрНоменклатура.ИспользованиеХарактеристик = ЗНАЧЕНИЕ(Перечисление.ВариантыИспользованияХарактеристикНоменклатуры.ИндивидуальныеДляНоменклатуры)
				ИЛИ СпрНоменклатура.ИспользованиеХарактеристик = ЗНАЧЕНИЕ(Перечисление.ВариантыИспользованияХарактеристикНоменклатуры.ОбщиеСДругимВидомНоменклатуры)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ КАК ХарактеристикиИспользуются,
	ТаблицаПланов.ДатаЗаказа КАК ДатаЗаказа,
	ТаблицаПланов.ДнейДоЗаказа КАК ДнейДоЗаказа,
	&amp;ТекстЗапросаВесНоменклатуры КАК Вес,
	&amp;ТекстЗапросаВесНоменклатуры * (ТаблицаПланов.КоличествоВПланах - ТаблицаПланов.КоличествоВЗаказах) КАК ОбщийВес,
	СпрНоменклатура.ТипНоменклатуры КАК ТипНоменклатуры,
	ЕСТЬNULL(СоглашенияСПоставщиками.Валюта, ВЫРАЗИТЬ(&amp;Сценарий КАК Справочник.СценарииТоварногоПланирования).Валюта) КАК Валюта,
	СоглашенияСПоставщиками.Организация КАК Организация,
	ВЫБОР
		КОГДА СоглашенияСПоставщиками.Валюта ЕСТЬ NULL
			ТОГДА ТаблицаПланов.ЦенаПлан
		КОГДА ЦеныНоменклатурыПоставщиковСрезПоследних.Цена ЕСТЬ NULL
			ТОГДА ВЫРАЗИТЬ(ТаблицаПланов.ЦенаПлан * ВЫБОР
						КОГДА СоглашенияСПоставщиками.Валюта &lt;&gt; ВЫРАЗИТЬ(&amp;Сценарий КАК Справочник.СценарииТоварногоПланирования).Валюта
							ТОГДА ВЫБОР
									КОГДА ЕСТЬNULL(КурсыВалютыСценария.КурсЗнаменатель, 0) &gt; 0
											И ЕСТЬNULL(КурсыВалютыСценария.КурсЧислитель, 0) &gt; 0
											И ЕСТЬNULL(КурсыВалюты.КурсЗнаменатель, 0) &gt; 0
											И ЕСТЬNULL(КурсыВалюты.КурсЧислитель, 0) &gt; 0
										ТОГДА КурсыВалютыСценария.КурсЧислитель * КурсыВалюты.КурсЗнаменатель / (КурсыВалюты.КурсЧислитель * КурсыВалютыСценария.КурсЗнаменатель)
									ИНАЧЕ 0
								КОНЕЦ
						ИНАЧЕ 1
					КОНЕЦ КАК ЧИСЛО(31, 2))
		ИНАЧЕ ВЫРАЗИТЬ(ЦеныНоменклатурыПоставщиковСрезПоследних.Цена / ЕСТЬNULL(&amp;ТекстЗапросаКоэффициентУпаковки, 1) * ВЫБОР
					КОГДА СоглашенияСПоставщиками.Валюта &lt;&gt; ЦеныНоменклатурыПоставщиковСрезПоследних.Валюта
						ТОГДА ВЫБОР
								КОГДА ЕСТЬNULL(КурсыВалютыЦены.КурсЗнаменатель, 0) &gt; 0
										И ЕСТЬNULL(КурсыВалютыЦены.КурсЧислитель, 0) &gt; 0
										И ЕСТЬNULL(КурсыВалюты.КурсЗнаменатель, 0) &gt; 0
										И ЕСТЬNULL(КурсыВалюты.КурсЧислитель, 0) &gt; 0
									ТОГДА КурсыВалютыЦены.КурсЧислитель * КурсыВалюты.КурсЗнаменатель / (КурсыВалюты.КурсЧислитель * КурсыВалютыЦены.КурсЗнаменатель)
								ИНАЧЕ 0
							КОНЕЦ
					ИНАЧЕ 1
				КОНЕЦ КАК ЧИСЛО(31, 2))
	КОНЕЦ КАК Цена,
	ВЫБОР
		КОГДА ТаблицаПланов.Подразделение = ЗНАЧЕНИЕ(Справочник.СтруктураПредприятия.ПустаяСсылка)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ КАК РедактироватьПодразделение,
	ВЫБОР
		КОГДА ТаблицаПланов.Партнер = ЗНАЧЕНИЕ(Справочник.Партнеры.ПустаяСсылка)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ КАК РедактироватьПартнер,
	ВЫБОР
		КОГДА ТаблицаПланов.Соглашение = ЗНАЧЕНИЕ(Справочник.СоглашенияСПоставщиками.ПустаяСсылка)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ КАК РедактироватьСоглашение,
	ВЫБОР
		КОГДА ТаблицаПланов.Склад = ЗНАЧЕНИЕ(Справочник.Склады.ПустаяСсылка)
			ТОГДА ИСТИНА
		ИНАЧЕ ЛОЖЬ
	КОНЕЦ КАК РедактироватьСклад,
	УсловияЗакупок.Упаковка КАК Упаковка,
	ЕСТЬNULL(УсловияЗакупок.МинимальнаяПартияПоставки, 0) КАК МинимальнаяПартияПоставки,
	ЕСТЬNULL(&amp;ТекстЗапросаУпаковкаЗаказаКоэффициент, 1) КАК КоэффициентУпаковки
ПОМЕСТИТЬ ОбеспеченныеПланы
{ВЫБРАТЬ
	Номенклатура.*,
	Характеристика.*,
	Назначение.*,
	Артикул,
	ДатаПоступления,
	ОкончаниеПериодаПоступления,
	КоличествоВПланах,
	КоличествоВЗаказах,
	КоличествоУпаковок,
	ХарактеристикиИспользуются,
	Партнер.*,
	Соглашение.*,
	ДатаЗаказа,
	ДнейДоЗаказа,
	Вес,
	ОбщийВес,
	Склад.*,
	ТипНоменклатуры.*,
	Подразделение.*}
ИЗ
	ТаблицаПлановСДатамиЗаказа КАК ТаблицаПланов
		ВНУТРЕННЕЕ СОЕДИНЕНИЕ Справочник.Номенклатура КАК СпрНоменклатура
		ПО ТаблицаПланов.Номенклатура = СпрНоменклатура.Ссылка
		ЛЕВОЕ СОЕДИНЕНИЕ Справочник.СоглашенияСПоставщиками КАК СоглашенияСПоставщиками
		ПО ТаблицаПланов.Соглашение = СоглашенияСПоставщиками.Ссылка
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ОтносительныеКурсыВалют.СрезПоследних(&amp;ТекущаяДата, БазоваяВалюта = &amp;БазоваяВалюта) КАК КурсыВалюты
		ПО (СоглашенияСПоставщиками.Валюта = КурсыВалюты.Валюта)
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ЦеныНоменклатурыПоставщиков.СрезПоследних(
				&amp;ТекущаяДата,
				(Партнер, Номенклатура, Характеристика) В
					(ВЫБРАТЬ РАЗЛИЧНЫЕ
						ТаблицаПланов.Партнер,
						ТаблицаПланов.Номенклатура,
						ТаблицаПланов.Характеристика
					ИЗ
						ТаблицаПлановСДатамиЗаказа КАК ТаблицаПланов)) КАК ЦеныНоменклатурыПоставщиковСрезПоследних
		ПО ТаблицаПланов.Соглашение.ВидЦеныПоставщика = ЦеныНоменклатурыПоставщиковСрезПоследних.ВидЦеныПоставщика
			И ТаблицаПланов.Номенклатура = ЦеныНоменклатурыПоставщиковСрезПоследних.Номенклатура
			И ТаблицаПланов.Характеристика = ЦеныНоменклатурыПоставщиковСрезПоследних.Характеристика
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ОтносительныеКурсыВалют.СрезПоследних(&amp;ТекущаяДата, БазоваяВалюта = &amp;БазоваяВалюта) КАК КурсыВалютыЦены
		ПО (ЦеныНоменклатурыПоставщиковСрезПоследних.Валюта = КурсыВалютыЦены.Валюта)
		ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.ОтносительныеКурсыВалют.СрезПоследних(&amp;ТекущаяДата, Валюта = ВЫРАЗИТЬ(&amp;Сценарий КАК Справочник.СценарииТоварногоПланирования).Валюта И БазоваяВалюта = &amp;БазоваяВалюта) КАК КурсыВалютыСценария
		ПО (ИСТИНА)
		ЛЕВОЕ СОЕДИНЕНИЕ УсловияЗакупок КАК УсловияЗакупок
		ПО ТаблицаПланов.Номенклатура = УсловияЗакупок.Номенклатура
			И ТаблицаПланов.Характеристика = УсловияЗакупок.Характеристика
			И ТаблицаПланов.Соглашение.ВидЦеныПоставщика = УсловияЗакупок.ВидЦеныПоставщика
{ГДЕ
	СпрНоменклатура.ТипНоменклатуры.*,
	ТаблицаПланов.Соглашение.*}
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ОбеспеченныеПланы.Подразделение КАК Подразделение,
	ОбеспеченныеПланы.Партнер КАК Партнер,
	ОбеспеченныеПланы.Соглашение КАК Соглашение,
	ОбеспеченныеПланы.Номенклатура КАК Номенклатура,
	ОбеспеченныеПланы.Характеристика КАК Характеристика,
	ОбеспеченныеПланы.Назначение КАК Назначение,
	ОбеспеченныеПланы.Склад КАК Склад,
	ОбеспеченныеПланы.Код КАК Код,
	ОбеспеченныеПланы.Артикул КАК Артикул,
	ОбеспеченныеПланы.ДатаПоступления КАК ДатаПоступления,
	ОбеспеченныеПланы.ОкончаниеПериодаПоступления КАК ОкончаниеПериодаПоступления,
	ОбеспеченныеПланы.КоличествоВПланах КАК КоличествоВПланах,
	ОбеспеченныеПланы.КоличествоВЗаказах КАК КоличествоВЗаказах,
	ОбеспеченныеПланы.КоличествоУпаковок КАК КоличествоУпаковок,
	ОбеспеченныеПланы.Количество КАК Количество,
	ОбеспеченныеПланы.ХарактеристикиИспользуются КАК ХарактеристикиИспользуются,
	ОбеспеченныеПланы.ДатаЗаказа КАК ДатаЗаказа,
	ОбеспеченныеПланы.ДнейДоЗаказа КАК ДнейДоЗаказа,
	ОбеспеченныеПланы.Вес КАК Вес,
	ОбеспеченныеПланы.ОбщийВес КАК ОбщийВес,
	ОбеспеченныеПланы.ТипНоменклатуры КАК ТипНоменклатуры,
	ОбеспеченныеПланы.Валюта КАК Валюта,
	ОбеспеченныеПланы.Организация КАК Организация,
	ОбеспеченныеПланы.Цена КАК Цена,
	ОбеспеченныеПланы.РедактироватьПодразделение КАК РедактироватьПодразделение,
	ОбеспеченныеПланы.РедактироватьПартнер КАК РедактироватьПартнер,
	ОбеспеченныеПланы.РедактироватьСоглашение КАК РедактироватьСоглашение,
	ОбеспеченныеПланы.РедактироватьСклад КАК РедактироватьСклад,
	ОбеспеченныеПланы.МинимальнаяПартияПоставки КАК МинимальнаяПартияПоставки,
	ОбеспеченныеПланы.Упаковка КАК Упаковка,
	ОбеспеченныеПланы.КоэффициентУпаковки КАК КоэффициентУпаковки
ПОМЕСТИТЬ ОбеспеченныеПланыСВычетомДляПрочихПодразделений
ИЗ
	ОбеспеченныеПланы КАК ОбеспеченныеПланы

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	ЗНАЧЕНИЕ(Справочник.СтруктураПредприятия.ПустаяСсылка),
	ОбеспеченныеПланы.Партнер,
	ОбеспеченныеПланы.Соглашение,
	ОбеспеченныеПланы.Номенклатура,
	ОбеспеченныеПланы.Характеристика,
	ОбеспеченныеПланы.Назначение,
	ОбеспеченныеПланы.Склад,
	ОбеспеченныеПланы.Код,
	ОбеспеченныеПланы.Артикул,
	ОбеспеченныеПланы.ДатаПоступления,
	ОбеспеченныеПланы.ОкончаниеПериодаПоступления,
	0,
	-ОбеспеченныеПланы.КоличествоВЗаказах,
	ОбеспеченныеПланы.КоличествоВЗаказах,
	ОбеспеченныеПланы.КоличествоВЗаказах,
	ОбеспеченныеПланы.ХарактеристикиИспользуются,
	ОбеспеченныеПланы.ДатаЗаказа,
	ОбеспеченныеПланы.ДнейДоЗаказа,
	ОбеспеченныеПланы.Вес,
	ОбеспеченныеПланы.ОбщийВес,
	ОбеспеченныеПланы.ТипНоменклатуры,
	ОбеспеченныеПланы.Валюта,
	ОбеспеченныеПланы.Организация,
	ОбеспеченныеПланы.Цена,
	ОбеспеченныеПланы.РедактироватьПодразделение,
	ОбеспеченныеПланы.РедактироватьПартнер,
	ОбеспеченныеПланы.РедактироватьСоглашение,
	ОбеспеченныеПланы.РедактироватьСклад,
	ОбеспеченныеПланы.МинимальнаяПартияПоставки,
	ОбеспеченныеПланы.Упаковка,
	ОбеспеченныеПланы.КоэффициентУпаковки
ИЗ
	ОбеспеченныеПланы КАК ОбеспеченныеПланы
ГДЕ
	ОбеспеченныеПланы.Подразделение &lt;&gt; ЗНАЧЕНИЕ(Справочник.СтруктураПредприятия.ПустаяСсылка)
	И ОбеспеченныеПланы.КоличествоВЗаказах &gt; 0
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ОбеспеченныеПланыСВычетомДляПрочихПодразделений.Подразделение КАК Подразделение,
	ОбеспеченныеПланыСВычетомДляПрочихПодразделений.Партнер КАК Партнер,
	ОбеспеченныеПланыСВычетомДляПрочихПодразделений.Соглашение КАК Соглашение,
	ОбеспеченныеПланыСВычетомДляПрочихПодразделений.Номенклатура КАК Номенклатура,
	ОбеспеченныеПланыСВычетомДляПрочихПодразделений.Характеристика КАК Характеристика,
	ОбеспеченныеПланыСВычетомДляПрочихПодразделений.Назначение КАК Назначение,
	ОбеспеченныеПланыСВычетомДляПрочихПодразделений.Назначение.НаправлениеДеятельности КАК НаправлениеДеятельности,
	ОбеспеченныеПланыСВычетомДляПрочихПодразделений.Склад КАК Склад,
	ОбеспеченныеПланыСВычетомДляПрочихПодразделений.Код КАК Код,
	ОбеспеченныеПланыСВычетомДляПрочихПодразделений.Артикул КАК Артикул,
	ОбеспеченныеПланыСВычетомДляПрочихПодразделений.ДатаПоступления КАК ДатаПоступления,
	ОбеспеченныеПланыСВычетомДляПрочихПодразделений.ОкончаниеПериодаПоступления КАК ОкончаниеПериодаПоступления,
	СУММА(ОбеспеченныеПланыСВычетомДляПрочихПодразделений.КоличествоВПланах) КАК КоличествоВПланах,
	СУММА(ОбеспеченныеПланыСВычетомДляПрочихПодразделений.КоличествоВЗаказах) КАК КоличествоВЗаказах,
	СУММА(ВЫБОР
			КОГДА ОбеспеченныеПланыСВычетомДляПрочихПодразделений.КоличествоУпаковок = 0 
				ТОГДА 0
			КОГДА ОбеспеченныеПланыСВычетомДляПрочихПодразделений.КоличествоУпаковок &gt; ОбеспеченныеПланыСВычетомДляПрочихПодразделений.МинимальнаяПартияПоставки * ОбеспеченныеПланыСВычетомДляПрочихПодразделений.КоэффициентУпаковки
				ТОГДА ОбеспеченныеПланыСВычетомДляПрочихПодразделений.КоличествоУпаковок / ОбеспеченныеПланыСВычетомДляПрочихПодразделений.КоэффициентУпаковки
			ИНАЧЕ ОбеспеченныеПланыСВычетомДляПрочихПодразделений.МинимальнаяПартияПоставки
		КОНЕЦ) КАК КоличествоУпаковок,
	СУММА(ОбеспеченныеПланыСВычетомДляПрочихПодразделений.Количество) КАК Количество,
	ОбеспеченныеПланыСВычетомДляПрочихПодразделений.ХарактеристикиИспользуются КАК ХарактеристикиИспользуются,
	ОбеспеченныеПланыСВычетомДляПрочихПодразделений.ДатаЗаказа КАК ДатаЗаказа,
	ОбеспеченныеПланыСВычетомДляПрочихПодразделений.ДнейДоЗаказа КАК ДнейДоЗаказа,
	ОбеспеченныеПланыСВычетомДляПрочихПодразделений.Вес КАК Вес,
	ВЫБОР
		КОГДА ОбеспеченныеПланыСВычетомДляПрочихПодразделений.КоличествоУпаковок &gt; ОбеспеченныеПланыСВычетомДляПрочихПодразделений.МинимальнаяПартияПоставки * ОбеспеченныеПланыСВычетомДляПрочихПодразделений.КоэффициентУпаковки
			ТОГДА ОбеспеченныеПланыСВычетомДляПрочихПодразделений.КоличествоУпаковок * ОбеспеченныеПланыСВычетомДляПрочихПодразделений.Вес
		ИНАЧЕ ОбеспеченныеПланыСВычетомДляПрочихПодразделений.МинимальнаяПартияПоставки * ОбеспеченныеПланыСВычетомДляПрочихПодразделений.КоэффициентУпаковки * ОбеспеченныеПланыСВычетомДляПрочихПодразделений.Вес
	КОНЕЦ КАК ОбщийВес,
	ОбеспеченныеПланыСВычетомДляПрочихПодразделений.ТипНоменклатуры КАК ТипНоменклатуры,
	ОбеспеченныеПланыСВычетомДляПрочихПодразделений.Валюта КАК Валюта,
	ОбеспеченныеПланыСВычетомДляПрочихПодразделений.Организация КАК Организация,
	ОбеспеченныеПланыСВычетомДляПрочихПодразделений.Цена / ОбеспеченныеПланыСВычетомДляПрочихПодразделений.КоэффициентУпаковки КАК Цена,
	ОбеспеченныеПланыСВычетомДляПрочихПодразделений.РедактироватьПодразделение КАК РедактироватьПодразделение,
	ОбеспеченныеПланыСВычетомДляПрочихПодразделений.РедактироватьПартнер КАК РедактироватьПартнер,
	ОбеспеченныеПланыСВычетомДляПрочихПодразделений.РедактироватьСоглашение КАК РедактироватьСоглашение,
	ОбеспеченныеПланыСВычетомДляПрочихПодразделений.РедактироватьСклад КАК РедактироватьСклад,
	ОбеспеченныеПланыСВычетомДляПрочихПодразделений.МинимальнаяПартияПоставки КАК МинимальнаяПартияПоставки,
	ОбеспеченныеПланыСВычетомДляПрочихПодразделений.Упаковка КАК Упаковка
ИЗ
	ОбеспеченныеПланыСВычетомДляПрочихПодразделений КАК ОбеспеченныеПланыСВычетомДляПрочихПодразделений

СГРУППИРОВАТЬ ПО
	ОбеспеченныеПланыСВычетомДляПрочихПодразделений.Подразделение,
	ОбеспеченныеПланыСВычетомДляПрочихПодразделений.Соглашение,
	ОбеспеченныеПланыСВычетомДляПрочихПодразделений.Склад,
	ОбеспеченныеПланыСВычетомДляПрочихПодразделений.Номенклатура,
	ОбеспеченныеПланыСВычетомДляПрочихПодразделений.Партнер,
	ОбеспеченныеПланыСВычетомДляПрочихПодразделений.Характеристика,
	ОбеспеченныеПланыСВычетомДляПрочихПодразделений.Назначение,
	ОбеспеченныеПланыСВычетомДляПрочихПодразделений.Код,
	ОбеспеченныеПланыСВычетомДляПрочихПодразделений.ДатаПоступления,
	ОбеспеченныеПланыСВычетомДляПрочихПодразделений.ТипНоменклатуры,
	ОбеспеченныеПланыСВычетомДляПрочихПодразделений.Валюта,
	ОбеспеченныеПланыСВычетомДляПрочихПодразделений.Организация,
	ОбеспеченныеПланыСВычетомДляПрочихПодразделений.Вес,
	ОбеспеченныеПланыСВычетомДляПрочихПодразделений.ХарактеристикиИспользуются,
	ОбеспеченныеПланыСВычетомДляПрочихПодразделений.ДатаЗаказа,
	ОбеспеченныеПланыСВычетомДляПрочихПодразделений.ОкончаниеПериодаПоступления,
	ОбеспеченныеПланыСВычетомДляПрочихПодразделений.Артикул,
	ОбеспеченныеПланыСВычетомДляПрочихПодразделений.ДнейДоЗаказа,
	ОбеспеченныеПланыСВычетомДляПрочихПодразделений.РедактироватьПодразделение,
	ОбеспеченныеПланыСВычетомДляПрочихПодразделений.Назначение.НаправлениеДеятельности,
	ОбеспеченныеПланыСВычетомДляПрочихПодразделений.РедактироватьПартнер,
	ОбеспеченныеПланыСВычетомДляПрочихПодразделений.РедактироватьСоглашение,
	ОбеспеченныеПланыСВычетомДляПрочихПодразделений.РедактироватьСклад,
	ОбеспеченныеПланыСВычетомДляПрочихПодразделений.МинимальнаяПартияПоставки,
	ОбеспеченныеПланыСВычетомДляПрочихПодразделений.Упаковка,
	ОбеспеченныеПланыСВычетомДляПрочихПодразделений.Цена / ОбеспеченныеПланыСВычетомДляПрочихПодразделений.КоэффициентУпаковки,
	ВЫБОР
		КОГДА ОбеспеченныеПланыСВычетомДляПрочихПодразделений.КоличествоУпаковок &gt; ОбеспеченныеПланыСВычетомДляПрочихПодразделений.МинимальнаяПартияПоставки * ОбеспеченныеПланыСВычетомДляПрочихПодразделений.КоэффициентУпаковки
			ТОГДА ОбеспеченныеПланыСВычетомДляПрочихПодразделений.КоличествоУпаковок * ОбеспеченныеПланыСВычетомДляПрочихПодразделений.Вес
		ИНАЧЕ ОбеспеченныеПланыСВычетомДляПрочихПодразделений.МинимальнаяПартияПоставки * ОбеспеченныеПланыСВычетомДляПрочихПодразделений.КоэффициентУпаковки * ОбеспеченныеПланыСВычетомДляПрочихПодразделений.Вес
	КОНЕЦ

ИМЕЮЩИЕ
	СУММА(ОбеспеченныеПланыСВычетомДляПрочихПодразделений.КоличествоВПланах) &gt; 0</query>
	</dataSet>
	<calculatedField>
		<dataPath>Сумма</dataPath>
		<expression>КоличествоУпаковок * Цена</expression>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Сумма</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:TypeId>48fa9d68-ae46-4d76-988a-88927f7a0ca6</v8:TypeId>
		</valueType>
	</calculatedField>
	<parameter>
		<name>НачалоПериода</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Начало периода</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type>xs:dateTime</v8:Type>
			<v8:DateQualifiers>
				<v8:DateFractions>DateTime</v8:DateFractions>
			</v8:DateQualifiers>
		</valueType>
		<value xsi:type="xs:dateTime">0001-01-01T00:00:00</value>
		<useRestriction>true</useRestriction>
		<availableAsField>false</availableAsField>
		<use>Always</use>
	</parameter>
	<parameter>
		<name>ОкончаниеПериода</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Окончание периода</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type>xs:dateTime</v8:Type>
			<v8:DateQualifiers>
				<v8:DateFractions>DateTime</v8:DateFractions>
			</v8:DateQualifiers>
		</valueType>
		<value xsi:type="xs:dateTime">0001-01-01T00:00:00</value>
		<useRestriction>true</useRestriction>
		<availableAsField>false</availableAsField>
		<use>Always</use>
	</parameter>
	<parameter>
		<name>Сценарий</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Сценарий</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type xmlns:d4p1="http://v8.1c.ru/8.1/data/enterprise/current-config">d4p1:CatalogRef.СценарииТоварногоПланирования</v8:Type>
		</valueType>
		<value xsi:type="dcscor:DesignTimeValue">Справочник.СценарииТоварногоПланирования.ПустаяСсылка</value>
		<useRestriction>false</useRestriction>
		<inputParameters>
			<dcscor:item>
				<dcscor:parameter>ПараметрыВыбора</dcscor:parameter>
				<dcscor:value xsi:type="dcscor:ChoiceParameters">
					<dcscor:item>
						<dcscor:choiceParameter>Отбор.ИспользоватьДляЗаказовПоставщику</dcscor:choiceParameter>
						<dcscor:value xsi:type="xs:boolean">true</dcscor:value>
					</dcscor:item>
				</dcscor:value>
			</dcscor:item>
		</inputParameters>
		<use>Always</use>
	</parameter>
	<parameter>
		<name>ПериодЗаказа</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Период заказа</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type>v8:StandardPeriod</v8:Type>
		</valueType>
		<value xsi:type="v8:StandardPeriod">
			<v8:variant xsi:type="v8:StandardPeriodVariant">Custom</v8:variant>
			<v8:startDate>0001-01-01T00:00:00</v8:startDate>
			<v8:endDate>0001-01-01T00:00:00</v8:endDate>
		</value>
		<useRestriction>false</useRestriction>
		<use>Always</use>
	</parameter>
	<parameter>
		<name>ПериодПоступления</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Период поступления</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type>v8:StandardPeriod</v8:Type>
		</valueType>
		<value xsi:type="v8:StandardPeriod">
			<v8:variant xsi:type="v8:StandardPeriodVariant">Custom</v8:variant>
			<v8:startDate>0001-01-01T00:00:00</v8:startDate>
			<v8:endDate>0001-01-01T00:00:00</v8:endDate>
		</value>
		<useRestriction>false</useRestriction>
	</parameter>
	<parameter>
		<name>Период</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Период</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type>xs:dateTime</v8:Type>
			<v8:DateQualifiers>
				<v8:DateFractions>DateTime</v8:DateFractions>
			</v8:DateQualifiers>
		</valueType>
		<value xsi:type="xs:dateTime">0001-01-01T00:00:00</value>
		<useRestriction>false</useRestriction>
	</parameter>
	<parameter>
		<name>ТекущаяДата</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Текущая дата</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type>xs:dateTime</v8:Type>
			<v8:DateQualifiers>
				<v8:DateFractions>DateTime</v8:DateFractions>
			</v8:DateQualifiers>
		</valueType>
		<value xsi:type="xs:dateTime">0001-01-01T00:00:00</value>
		<useRestriction>true</useRestriction>
		<expression>ТекущаяДата()</expression>
		<availableAsField>false</availableAsField>
		<use>Always</use>
	</parameter>
	<parameter>
		<name>КонецПериода</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Конец периода</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type>xs:dateTime</v8:Type>
			<v8:DateQualifiers>
				<v8:DateFractions>DateTime</v8:DateFractions>
			</v8:DateQualifiers>
		</valueType>
		<value xsi:type="xs:dateTime">0001-01-01T00:00:00</value>
		<useRestriction>false</useRestriction>
	</parameter>
	<parameter>
		<name>ДатаНачалаЗаказа</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Дата начала заказа</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type>xs:dateTime</v8:Type>
			<v8:DateQualifiers>
				<v8:DateFractions>DateTime</v8:DateFractions>
			</v8:DateQualifiers>
		</valueType>
		<value xsi:type="xs:dateTime">0001-01-01T00:00:00</value>
		<useRestriction>true</useRestriction>
		<availableAsField>false</availableAsField>
		<use>Always</use>
	</parameter>
	<parameter>
		<name>ДатаОкончанияЗаказа</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Дата окончания заказа</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type>xs:dateTime</v8:Type>
			<v8:DateQualifiers>
				<v8:DateFractions>DateTime</v8:DateFractions>
			</v8:DateQualifiers>
		</valueType>
		<value xsi:type="xs:dateTime">0001-01-01T00:00:00</value>
		<useRestriction>true</useRestriction>
		<availableAsField>false</availableAsField>
		<use>Always</use>
	</parameter>
	<parameter>
		<name>Периодичность</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Периодичность</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type xmlns:d4p1="http://v8.1c.ru/8.1/data/enterprise/current-config">d4p1:EnumRef.Периодичность</v8:Type>
		</valueType>
		<value xsi:nil="true"/>
		<useRestriction>true</useRestriction>
		<availableAsField>false</availableAsField>
		<use>Always</use>
	</parameter>
	<parameter>
		<name>ТекстЗапросаВесНоменклатуры</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Текст запроса вес номенклатуры</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type>xs:decimal</v8:Type>
			<v8:NumberQualifiers>
				<v8:Digits>0</v8:Digits>
				<v8:FractionDigits>0</v8:FractionDigits>
				<v8:AllowedSign>Any</v8:AllowedSign>
			</v8:NumberQualifiers>
		</valueType>
		<value xsi:type="xs:decimal">0</value>
		<useRestriction>true</useRestriction>
		<availableAsField>false</availableAsField>
	</parameter>
	<parameter>
		<name>ТекстЗапросаКоэффициентУпаковки</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Текст запроса коэффициент упаковки</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type>xs:decimal</v8:Type>
			<v8:NumberQualifiers>
				<v8:Digits>0</v8:Digits>
				<v8:FractionDigits>0</v8:FractionDigits>
				<v8:AllowedSign>Any</v8:AllowedSign>
			</v8:NumberQualifiers>
		</valueType>
		<value xsi:type="xs:decimal">0</value>
		<useRestriction>true</useRestriction>
		<availableAsField>false</availableAsField>
	</parameter>
	<parameter>
		<name>Назначение</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Назначение</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type xmlns:d4p1="http://v8.1c.ru/8.1/data/enterprise/current-config">d4p1:CatalogRef.Назначения</v8:Type>
		</valueType>
		<value xsi:nil="true"/>
		<useRestriction>true</useRestriction>
	</parameter>
	<parameter>
		<name>ОтборПоНазначению</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Отбор по назначению</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type>xs:boolean</v8:Type>
		</valueType>
		<value xsi:type="xs:boolean">false</value>
		<useRestriction>true</useRestriction>
	</parameter>
	<parameter>
		<name>ПланированиеПоНазначениям</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Планирование по назначениям</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type>xs:boolean</v8:Type>
		</valueType>
		<value xsi:type="xs:boolean">false</value>
		<useRestriction>true</useRestriction>
	</parameter>
	<parameter>
		<name>ПодстановкаОсновногоСпособаОбеспечения</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Подстановка основного способа обеспечения</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type>xs:boolean</v8:Type>
		</valueType>
		<value xsi:type="xs:boolean">false</value>
		<useRestriction>true</useRestriction>
	</parameter>
	<parameter>
		<name>ПериодНачало</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Период начало</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type>xs:dateTime</v8:Type>
			<v8:DateQualifiers>
				<v8:DateFractions>DateTime</v8:DateFractions>
			</v8:DateQualifiers>
		</valueType>
		<value xsi:type="xs:dateTime">0001-01-01T00:00:00</value>
		<useRestriction>false</useRestriction>
		<use>Always</use>
	</parameter>
	<parameter>
		<name>ПериодОкончание</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Период окончание</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type>xs:dateTime</v8:Type>
			<v8:DateQualifiers>
				<v8:DateFractions>DateTime</v8:DateFractions>
			</v8:DateQualifiers>
		</valueType>
		<value xsi:type="xs:dateTime">0001-01-01T00:00:00</value>
		<useRestriction>false</useRestriction>
		<use>Always</use>
	</parameter>
	<parameter>
		<name>ИспользуетсяОтборПоСегментуНоменклатуры</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Используется отбор по сегменту номенклатуры</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type>xs:boolean</v8:Type>
		</valueType>
		<value xsi:type="xs:boolean">false</value>
		<useRestriction>true</useRestriction>
		<availableAsField>false</availableAsField>
	</parameter>
	<parameter>
		<name>ТекстЗапросаУпаковкаЗаказаКоэффициент</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Текст запроса упаковка заказа коэффициент</v8:content>
			</v8:item>
		</title>
		<value xsi:nil="true"/>
		<useRestriction>true</useRestriction>
	</parameter>
	<parameter>
		<name>БазоваяВалюта</name>
		<title xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Базовая валюта</v8:content>
			</v8:item>
		</title>
		<valueType>
			<v8:Type xmlns:d4p1="http://v8.1c.ru/8.1/data/enterprise/current-config">d4p1:CatalogRef.Валюты</v8:Type>
		</valueType>
		<value xsi:nil="true"/>
		<useRestriction>true</useRestriction>
		<expression>Константы.БазоваяВалютаПоУмолчанию.Получить()</expression>
		<availableAsField>false</availableAsField>
	</parameter>
	<settingsVariant>
		<dcsset:name>Основной</dcsset:name>
		<dcsset:presentation xsi:type="v8:LocalStringType">
			<v8:item>
				<v8:lang>ru</v8:lang>
				<v8:content>Основной</v8:content>
			</v8:item>
		</dcsset:presentation>
		<dcsset:settings xmlns:style="http://v8.1c.ru/8.1/data/ui/style" xmlns:sys="http://v8.1c.ru/8.1/data/ui/fonts/system" xmlns:web="http://v8.1c.ru/8.1/data/ui/colors/web" xmlns:win="http://v8.1c.ru/8.1/data/ui/colors/windows">
			<dcsset:selection>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>Партнер</dcsset:field>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>Соглашение</dcsset:field>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>Код</dcsset:field>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>Артикул</dcsset:field>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>ДатаПоступления</dcsset:field>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>Количество</dcsset:field>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>КоличествоУпаковок</dcsset:field>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>Назначение</dcsset:field>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>КоличествоВЗаказах</dcsset:field>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>КоличествоВПланах</dcsset:field>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>ОкончаниеПериодаПоступления</dcsset:field>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>Номенклатура</dcsset:field>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>Характеристика</dcsset:field>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>ХарактеристикиИспользуются</dcsset:field>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>Цена</dcsset:field>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>Сумма</dcsset:field>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>ДнейДоЗаказа</dcsset:field>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>ДатаЗаказа</dcsset:field>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>ОбщийВес</dcsset:field>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>Вес</dcsset:field>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>Склад</dcsset:field>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>ТипНоменклатуры</dcsset:field>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>Валюта</dcsset:field>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>Организация</dcsset:field>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>Подразделение</dcsset:field>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>РедактироватьПодразделение</dcsset:field>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>НаправлениеДеятельности</dcsset:field>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>РедактироватьНазначение</dcsset:field>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>РедактироватьПартнер</dcsset:field>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>РедактироватьСклад</dcsset:field>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>РедактироватьСоглашение</dcsset:field>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>МинимальнаяПартияПоставки</dcsset:field>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:SelectedItemField">
					<dcsset:field>Упаковка</dcsset:field>
				</dcsset:item>
			</dcsset:selection>
			<dcsset:filter>
				<dcsset:item xsi:type="dcsset:FilterItemComparison">
					<dcsset:use>false</dcsset:use>
					<dcsset:left xsi:type="dcscor:Field">Поставщик</dcsset:left>
					<dcsset:comparisonType>Equal</dcsset:comparisonType>
					<dcsset:right xsi:type="dcscor:DesignTimeValue">Справочник.Партнеры.ПустаяСсылка</dcsset:right>
					<dcsset:userSettingID>37414fcd-5f89-449c-82d9-098fa739068e</dcsset:userSettingID>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:FilterItemComparison">
					<dcsset:use>false</dcsset:use>
					<dcsset:left xsi:type="dcscor:Field">Номенклатура</dcsset:left>
					<dcsset:comparisonType>InHierarchy</dcsset:comparisonType>
					<dcsset:right xsi:type="dcscor:DesignTimeValue">Справочник.Номенклатура.ПустаяСсылка</dcsset:right>
					<dcsset:userSettingID>b8263109-47fc-4ade-90d1-31facd9e7f14</dcsset:userSettingID>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:FilterItemComparison">
					<dcsset:use>false</dcsset:use>
					<dcsset:left xsi:type="dcscor:Field">СегментНоменклатуры</dcsset:left>
					<dcsset:comparisonType>Equal</dcsset:comparisonType>
					<dcsset:right xsi:type="dcscor:DesignTimeValue">Справочник.СегментыНоменклатуры.ПустаяСсылка</dcsset:right>
					<dcsset:userSettingID>8786fd2b-143e-4cbe-87fc-cd1f8134ab97</dcsset:userSettingID>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:FilterItemComparison">
					<dcsset:use>false</dcsset:use>
					<dcsset:left xsi:type="dcscor:Field">Склад</dcsset:left>
					<dcsset:comparisonType>Equal</dcsset:comparisonType>
					<dcsset:right xsi:type="dcscor:DesignTimeValue">Справочник.Склады.ПустаяСсылка</dcsset:right>
					<dcsset:userSettingID>d2f2b3bc-ee3a-4977-8592-86957a35e103</dcsset:userSettingID>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:FilterItemComparison">
					<dcsset:use>false</dcsset:use>
					<dcsset:left xsi:type="dcscor:Field">Соглашение</dcsset:left>
					<dcsset:comparisonType>Equal</dcsset:comparisonType>
					<dcsset:right xsi:type="dcscor:DesignTimeValue">Справочник.СоглашенияСПоставщиками.ПустаяСсылка</dcsset:right>
					<dcsset:userSettingID>805b5e65-8d2f-4ec0-8d1b-8b8b48715bfb</dcsset:userSettingID>
				</dcsset:item>
				<dcsset:userSettingID>8d3cf343-e5d2-4767-846c-333115db71cb</dcsset:userSettingID>
			</dcsset:filter>
			<dcsset:dataParameters>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:parameter>Сценарий</dcscor:parameter>
					<dcscor:value xsi:type="dcscor:DesignTimeValue">Справочник.СценарииТоварногоПланирования.ПустаяСсылка</dcscor:value>
					<dcsset:userSettingID>1412e058-fc70-4a42-aa43-a5a3ce3de097</dcsset:userSettingID>
				</dcscor:item>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:parameter>ПериодНачало</dcscor:parameter>
					<dcscor:value xsi:type="v8:StandardBeginningDate">
						<v8:variant xsi:type="v8:StandardBeginningDateVariant">Custom</v8:variant>
						<v8:date>0001-01-01T00:00:00</v8:date>
					</dcscor:value>
					<dcsset:userSettingID>d46d581b-b925-48fa-af4a-cf0df6e35f75</dcsset:userSettingID>
				</dcscor:item>
				<dcscor:item xsi:type="dcsset:SettingsParameterValue">
					<dcscor:parameter>ПериодОкончание</dcscor:parameter>
					<dcscor:value xsi:type="v8:StandardBeginningDate">
						<v8:variant xsi:type="v8:StandardBeginningDateVariant">Custom</v8:variant>
						<v8:date>0001-01-01T00:00:00</v8:date>
					</dcscor:value>
					<dcsset:userSettingID>edc42bf8-1ae0-4deb-9a09-0f5eb9e104d6</dcsset:userSettingID>
				</dcscor:item>
			</dcsset:dataParameters>
			<dcsset:order>
				<dcsset:item xsi:type="dcsset:OrderItemField">
					<dcsset:field>Номенклатура</dcsset:field>
					<dcsset:orderType>Asc</dcsset:orderType>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:OrderItemField">
					<dcsset:field>Артикул</dcsset:field>
					<dcsset:orderType>Asc</dcsset:orderType>
				</dcsset:item>
				<dcsset:item xsi:type="dcsset:OrderItemField">
					<dcsset:field>Характеристика</dcsset:field>
					<dcsset:orderType>Asc</dcsset:orderType>
				</dcsset:item>
			</dcsset:order>
			<dcsset:item xsi:type="dcsset:StructureItemGroup">
				<dcsset:order>
					<dcsset:item xsi:type="dcsset:OrderItemAuto"/>
				</dcsset:order>
				<dcsset:selection>
					<dcsset:item xsi:type="dcsset:SelectedItemAuto"/>
				</dcsset:selection>
			</dcsset:item>
		</dcsset:settings>
	</settingsVariant>
</DataCompositionSchema>